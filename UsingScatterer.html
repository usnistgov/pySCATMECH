
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Using the Scatterer module &#8212; pySCATMECH 0.1.9 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/nature.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Using the RCW module" href="UsingRCW.html" />
    <link rel="prev" title="Using the Integrate module" href="UsingIntegrate.html" />
<link rel="stylesheet" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css">
  <script src="https://code.jquery.com/jquery-1.12.4.min.js" type="text/javascript"></script>
  <script src="https://pages.nist.gov/nist-header-footer/js/nist-header-footer.js" type="text/javascript" defer="defer"></script>

<script async type="text/javascript" id="_fed_an_ua_tag" src="https://dap.digitalgov.gov/Universal-Federated-Analytics-Min.js?agency=NIST&subagency=github&pua=UA-66610693-1&yt=true&exts=ppsx,pps,f90,sch,rtf,wrl,txz,m1v,xlsm,msi,xsd,f,tif,eps,mpg,xml,pl,xlt,c">
</script>

  
<script type="text/javascript" src="https://pages.nist.gov/leaveNotice/js/jquery.leaveNotice-nist.min.js"></script>
<script>
$(document).ready(function(){
  // Mark external (non-nist.gov) A tags with class "external"
  //If the adress start with https and ends with nist.gov
  var re_nist = new RegExp('^https?:\/\/((^\/)*\.)*nist\\.gov(\/|$)');
  //Regex to find address that start with https
  var re_absolute_address = new RegExp('^((https?:)?\/\/)');
  $("a").each(function(){
    var url=$(this).attr('href');
    if(re_nist.test(url) || !re_absolute_address.test(url)){
      $(this).addClass('local');
    }else{
      //This a href appears to be external, so tag it
      $(this).addClass('external');
    }
  });
  // Add leaveNotice to external A elements
  $('a.external').leaveNotice();
});
</script>
<link rel="stylesheet" type="text/css" href="https://pages.nist.gov/leaveNotice/css/jquery.leaveNotice.css" />


  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="UsingRCW.html" title="Using the RCW module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="UsingIntegrate.html" title="Using the Integrate module"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pySCATMECH 0.1.9 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Using the Scatterer module</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<section id="Using-the-Scatterer-module">
<h1>Using the Scatterer module<a class="headerlink" href="#Using-the-Scatterer-module" title="Permalink to this heading">¶</a></h1>
<p>In this notebook, we will be describing how to use the <code class="docutils literal notranslate"><span class="pre">Free_Space_Scatterer</span></code> class provided in the Scatterer module. This class provides access to the functions provided by the <code class="docutils literal notranslate"><span class="pre">Free_Space_Scatterer</span></code> class of SCATMECH. These include the models * RayleighScatterer * RayleighGansSphereScatterer * MieScatterer * CoatedMieScatterer * MultilayerCoatedMieScatterer * Optically_Active_Sphere_Scatterer * TMatrix_Axisymmetric_Scatterer</p>
<p>First, import the libraries we will need. We will be graphing some data, and using the NumPy package.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pySCATMECH.scatterer</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
<section id="Mie-scattering">
<h2>Mie scattering<a class="headerlink" href="#Mie-scattering" title="Permalink to this heading">¶</a></h2>
<p>Let’s start by looking at scattering by homogeneous spheres (Mie scatering). We start by creating a model and setting its parameters:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lambda&#39;</span> <span class="p">:</span> <span class="mf">0.532</span><span class="p">,</span>
            <span class="s1">&#39;medium&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;radius&#39;</span> <span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
            <span class="s1">&#39;sphere&#39;</span> <span class="p">:</span> <span class="mf">1.59</span><span class="p">}</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Free_Space_Scatterer</span><span class="p">(</span><span class="s2">&quot;MieScatterer&quot;</span><span class="p">,</span><span class="n">parameters</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{None : &#39;MieScatterer&#39;,
&#39;lambda&#39; : &#39;0.532&#39;,
&#39;medium&#39; : &#39;(1,0)&#39;,
&#39;radius&#39; : &#39;0.1&#39;,
&#39;sphere&#39; : &#39;(1.59,0)&#39;}
</pre></div></div>
</div>
<p>We can evaluate the Mueller matrix differential scattering cross section in any pair of directions, defined by two directional vectors. The basis set for the Mueller matrix is perpendicular and parallel to the plane of scattering, defined by the incident and scattering directions.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">theta</span> <span class="o">=</span> <span class="mi">45</span><span class="o">*</span><span class="n">deg</span>

<span class="n">vin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">vout</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)]</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">DifferentialScatteringCrossSection</span><span class="p">(</span><span class="n">vin</span><span class="p">,</span><span class="n">vout</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[ 2.30829762e-03 -6.16046580e-04  0.00000000e+00  0.00000000e+00]
 [-6.16046580e-04  2.30829762e-03  0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  2.22445889e-03 -2.25210041e-05]
 [ 0.00000000e+00  0.00000000e+00  2.25210041e-05  2.22445889e-03]]
</pre></div></div>
</div>
<p>Let’s plot the scattering function:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">dsc</span><span class="p">(</span><span class="n">theta</span><span class="p">):</span>
    <span class="n">vin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">vout</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">DifferentialScatteringCrossSection</span><span class="p">(</span><span class="n">vin</span><span class="p">,</span><span class="n">vout</span><span class="p">)</span>

<span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">,</span><span class="mi">180</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">dsc</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="k">for</span> <span class="n">angle</span> <span class="ow">in</span> <span class="n">angles</span><span class="p">]</span>

<span class="n">spol</span> <span class="o">=</span> <span class="n">Polarization</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)</span> <span class="c1"># perpendicular to the scattering plane</span>
<span class="n">ppol</span> <span class="o">=</span> <span class="n">Polarization</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">)</span> <span class="c1"># parallel to the scattering plane</span>
<span class="n">upol</span> <span class="o">=</span> <span class="n">Polarization</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">)</span> <span class="c1"># unpolarized</span>
<span class="n">usens</span> <span class="o">=</span> <span class="n">Sensitivity</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">)</span> <span class="c1"># unpolarized sensitivity</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">polar</span><span class="p">(</span><span class="n">angles</span><span class="p">,</span> <span class="p">[</span><span class="n">usens</span> <span class="o">@</span> <span class="n">r</span> <span class="o">@</span> <span class="n">upol</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;unpol&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">polar</span><span class="p">(</span><span class="n">angles</span><span class="p">,</span> <span class="p">[</span><span class="n">usens</span> <span class="o">@</span> <span class="n">r</span> <span class="o">@</span> <span class="n">spol</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;perp&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">polar</span><span class="p">(</span><span class="n">angles</span><span class="p">,</span> <span class="p">[</span><span class="n">usens</span> <span class="o">@</span> <span class="n">r</span> <span class="o">@</span> <span class="n">ppol</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;par&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="Graph showing results of preceding Python code: Polar graph with three curves" src="_images/UsingScatterer_8_0.svg" /></div>
</div>
<p>In this next step, we look at a 0.04 µm diameter gold sphere as a function of wavelength. Here, we integrate the scatter and show the total scattering cross section as a function of wavelength. Notice the surface plasmon resonance at around 0.52 µm.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lambda&#39;</span> <span class="p">:</span> <span class="mf">0.532</span><span class="p">,</span>
            <span class="s1">&#39;medium&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;radius&#39;</span> <span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span>
            <span class="s1">&#39;sphere&#39;</span> <span class="p">:</span> <span class="s1">&#39;gold&#39;</span><span class="p">}</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Free_Space_Scatterer</span><span class="p">(</span><span class="s2">&quot;MieScatterer&quot;</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">integrate_scatter</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">wavelength</span><span class="p">,</span> <span class="n">steps</span><span class="p">):</span>
    <span class="s2">&quot;Integrate `model` at `wavelength`, performing the integral in `steps` steps.&quot;</span>
    <span class="n">integ</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">dtheta</span> <span class="o">=</span> <span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="n">steps</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;lambda&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wavelength</span>
    <span class="n">model</span><span class="o">.</span><span class="n">setParameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
    <span class="n">vin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">dtheta</span><span class="p">)</span>
    <span class="c1"># Integrate angles from 0 to pi...</span>
    <span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">angles</span><span class="p">:</span>
        <span class="n">vout</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)]</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">DifferentialScatteringCrossSection</span><span class="p">(</span><span class="n">vin</span><span class="p">,</span> <span class="n">vout</span><span class="p">)</span>
        <span class="n">integ</span> <span class="o">+=</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>
    <span class="n">integ</span> <span class="o">*=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">dtheta</span>
    <span class="k">return</span> <span class="n">integ</span>

<span class="n">wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.380</span><span class="p">,</span><span class="mf">0.780</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

<span class="c1"># Diameter 0.04 µm...</span>
<span class="n">D</span> <span class="o">=</span> <span class="mf">0.04</span>
<span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">D</span><span class="o">/</span><span class="mi">2</span>
<span class="n">model</span><span class="o">.</span><span class="n">setParameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>

<span class="n">crosssection</span> <span class="o">=</span> <span class="p">[</span><span class="n">integrate_scatter</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span> <span class="k">for</span> <span class="n">L</span> <span class="ow">in</span> <span class="n">wavelengths</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">crosssection</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;D = </span><span class="si">%g</span><span class="s2"> µm&quot;</span><span class="o">%</span><span class="k">D</span>)

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Wavelength [µm]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Cross section [µm$^2$]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="Graph showing results of preceding Python code: A peak around 0.520 micrometers" src="_images/UsingScatterer_10_0.svg" /></div>
</div>
</section>
<section id="Mie-scattering-with-a-coating">
<h2>Mie scattering with a coating<a class="headerlink" href="#Mie-scattering-with-a-coating" title="Permalink to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">CoatedMieScatterer</span></code> model implements Mie theory extended to coated spheres. Let’s see what the absorption, scattering, and extinction cross sections look like for different thicknesses of gold on glass spheres in water.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lambda&#39;</span> <span class="p">:</span> <span class="mf">0.532</span><span class="p">,</span>
            <span class="s1">&#39;medium&#39;</span> <span class="p">:</span> <span class="s1">&#39;water&#39;</span><span class="p">,</span>
            <span class="s1">&#39;radius&#39;</span> <span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span>
            <span class="s1">&#39;sphere&#39;</span> <span class="p">:</span> <span class="s1">&#39;glass&#39;</span><span class="p">,</span>
            <span class="s1">&#39;coating&#39;</span> <span class="p">:</span> <span class="s1">&#39;gold&#39;</span><span class="p">,</span>
            <span class="s1">&#39;thickness&#39;</span> <span class="p">:</span> <span class="mf">0.005</span><span class="p">}</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Free_Space_Scatterer</span><span class="p">(</span><span class="s2">&quot;CoatedMieScatterer&quot;</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">extinction</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">wavelength</span><span class="p">):</span>
    <span class="s2">&quot;Calculate the extinction coefficient at a given `wavelength` for a given `model`.&quot;</span>
    <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;lambda&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wavelength</span>
    <span class="n">model</span><span class="o">.</span><span class="n">setParameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
    <span class="n">vin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">Extinction</span><span class="p">(</span><span class="n">vin</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">integrated_scatter</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">wavelength</span><span class="p">,</span><span class="n">steps</span><span class="p">):</span>
    <span class="s2">&quot;Integrate the scatter over polar angle&quot;</span>
    <span class="n">integ</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">dtheta</span> <span class="o">=</span> <span class="n">pi</span><span class="o">/</span><span class="p">(</span><span class="n">steps</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;lambda&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wavelength</span>
    <span class="n">model</span><span class="o">.</span><span class="n">setParameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
    <span class="n">vin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">steps</span><span class="p">):</span>
        <span class="n">vout</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)]</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">DifferentialScatteringCrossSection</span><span class="p">(</span><span class="n">vin</span><span class="p">,</span> <span class="n">vout</span><span class="p">)</span>
        <span class="n">integ</span> <span class="o">+=</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>
    <span class="n">integ</span> <span class="o">*=</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">dtheta</span>
    <span class="k">return</span> <span class="n">integ</span>

<span class="n">wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.500</span><span class="p">,</span> <span class="mf">1.300</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">)</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">)</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.002</span><span class="p">,</span><span class="mf">0.003</span><span class="p">,</span><span class="mf">0.004</span><span class="p">,</span><span class="mf">0.005</span><span class="p">,</span><span class="mf">0.006</span><span class="p">,</span><span class="mf">0.007</span><span class="p">,</span><span class="mf">0.008</span><span class="p">]:</span>
    <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;thickness&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span>
    <span class="n">sca</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">integrated_scatter</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span> <span class="k">for</span> <span class="n">L</span> <span class="ow">in</span> <span class="n">wavelengths</span><span class="p">])</span>
    <span class="n">ext</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">extinction</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">L</span><span class="p">)</span> <span class="k">for</span> <span class="n">L</span> <span class="ow">in</span> <span class="n">wavelengths</span><span class="p">])</span>
    <span class="nb">abs</span> <span class="o">=</span> <span class="n">ext</span><span class="o">-</span><span class="n">sca</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">sca</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;t = </span><span class="si">%g</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">t</span>)
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">ext</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;t = </span><span class="si">%g</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">t</span>)
    <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span> <span class="nb">abs</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;t = </span><span class="si">%g</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">t</span>)

<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Scattering&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Extinction&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Absorption&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Cross Section [µm$^2$/1000]&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Wavelength [µm]&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Wavelength [µm]&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Wavelength [µm]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="Graph showing results of preceding Python code: Three graphs, each with seven curves, showing scattering, extinction, and absorption." src="_images/UsingScatterer_13_0.svg" /></div>
</div>
</section>
<section id="Optically-active-sphere">
<h2>Optically active sphere<a class="headerlink" href="#Optically-active-sphere" title="Permalink to this heading">¶</a></h2>
<p>In the following, we look at the extinction matrix for a 2 µm diameter sphere that has a small index difference for right-hand-circular polarization (typical numbers for sucrose). The resulting matrix shows some optical rotation and some circular diattenuation.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;lambda&#39;</span> <span class="p">:</span> <span class="mf">0.589</span><span class="p">,</span>
            <span class="s1">&#39;medium&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;radius&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;materialright&#39;</span> <span class="p">:</span> <span class="mf">1.56</span><span class="o">+</span> <span class="mf">6.9E-7</span><span class="p">,</span>
            <span class="s1">&#39;materialleft&#39;</span> <span class="p">:</span> <span class="mf">1.56</span><span class="p">}</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Free_Space_Scatterer</span><span class="p">(</span><span class="s2">&quot;Optically_Active_Sphere_Scatterer&quot;</span><span class="p">,</span><span class="n">parameters</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">extinction</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">wavelength</span><span class="p">):</span>
    <span class="n">model</span><span class="o">.</span><span class="n">setParameters</span><span class="p">(</span><span class="n">wavelength</span><span class="o">=</span><span class="n">wavelength</span><span class="p">)</span>
    <span class="n">vin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">Extinction</span><span class="p">(</span><span class="n">vin</span><span class="p">)</span>

<span class="n">extmatrix</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Extinction</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">extmatrix</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[ 8.32522992e+00  0.00000000e+00  0.00000000e+00  7.94028248e-06]
 [ 0.00000000e+00  8.32522992e+00  3.05860149e-06 -0.00000000e+00]
 [ 0.00000000e+00 -3.05860149e-06  8.32522992e+00  0.00000000e+00]
 [ 7.94028248e-06  0.00000000e+00 -0.00000000e+00  8.32522992e+00]]
</pre></div></div>
</div>
</section>
<section id="Ellipsoids">
<h2>Ellipsoids<a class="headerlink" href="#Ellipsoids" title="Permalink to this heading">¶</a></h2>
<p>In the following, we calculate the extinction coefficient for ellipsoidal gold particles, where the major axis is 20 µm and the minor axis is 6 µm. We then calculate the Mueller matrix transmittance assuming a concentration-thickness product of 105 µm-2. When the radiation is incident perpendicular to the axis of the ellipsoids, the resulting Mueller matrix behaves very much like a polarizer. When the radiation is incident along the axis of the ellipsoids, the resulting Mueller matrix is just
absorbing.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">shape</span> <span class="o">=</span> <span class="p">{</span><span class="kc">None</span> <span class="p">:</span> <span class="s1">&#39;Ellipsoid_Axisymmetric_Shape&#39;</span><span class="p">,</span>
        <span class="s1">&#39;npoints&#39;</span> <span class="p">:</span> <span class="s1">&#39;100&#39;</span><span class="p">,</span>
        <span class="s1">&#39;vertical&#39;</span> <span class="p">:</span> <span class="s1">&#39;0.010&#39;</span><span class="p">,</span>
        <span class="s1">&#39;horizontal&#39;</span> <span class="p">:</span> <span class="s1">&#39;0.003&#39;</span>
        <span class="p">}</span>

<span class="n">tmatrix</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;lambda&#39;</span> <span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
        <span class="s1">&#39;medium&#39;</span> <span class="p">:</span> <span class="mf">1.4</span><span class="p">,</span>
        <span class="s1">&#39;Shape&#39;</span> <span class="p">:</span> <span class="n">shape</span><span class="p">,</span>
        <span class="s1">&#39;particle&#39;</span> <span class="p">:</span> <span class="s1">&#39;gold&#39;</span><span class="p">,</span>
        <span class="s1">&#39;lmax&#39;</span> <span class="p">:</span> <span class="s1">&#39;30&#39;</span><span class="p">,</span>
        <span class="s1">&#39;mmax&#39;</span> <span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">}</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Free_Space_Scatterer</span><span class="p">(</span><span class="s2">&quot;TMatrix_Axisymmetric_Scatterer&quot;</span><span class="p">,</span><span class="n">tmatrix</span><span class="p">)</span>

<span class="n">extCoeff100</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Extinction</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">extCoeff001</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Extinction</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mueller matrix transmittance perpendicular to ellipsoid axis:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">MuellerExp</span><span class="p">(</span><span class="o">-</span><span class="n">extCoeff100</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="mi">5</span><span class="p">),</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mueller matrix transmittance parallel to ellipsoid axis:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">MuellerExp</span><span class="p">(</span><span class="o">-</span><span class="n">extCoeff001</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="mi">5</span><span class="p">),</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Mueller matrix transmittance perpendicular to ellipsoid axis:
[[ 4.90951752e-01  4.90951752e-01  8.56709626e-24  6.07946914e-24]
 [ 4.90951752e-01  4.90951752e-01  8.55781735e-24  6.05189921e-24]
 [-1.63365318e-22 -1.63342992e-22 -3.18191980e-06  7.75832676e-06]
 [-1.47979786e-21 -1.47981003e-21 -7.75832676e-06 -3.18191980e-06]]

Mueller matrix transmittance parallel to ellipsoid axis:
[[ 1.01786040e+00 -2.45123552e-07 -2.47343011e-17  6.68348925e-19]
 [-2.45123552e-07  1.01786040e+00  4.12590470e-18  2.27875239e-19]
 [-2.47343002e-17 -4.12589871e-18  1.01786040e+00 -1.83673418e-07]
 [ 6.68344506e-19 -2.27876151e-19  1.83673418e-07  1.01786040e+00]]

</pre></div></div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Using the Scatterer module</a><ul>
<li><a class="reference internal" href="#Mie-scattering">Mie scattering</a></li>
<li><a class="reference internal" href="#Mie-scattering-with-a-coating">Mie scattering with a coating</a></li>
<li><a class="reference internal" href="#Optically-active-sphere">Optically active sphere</a></li>
<li><a class="reference internal" href="#Ellipsoids">Ellipsoids</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="UsingIntegrate.html"
                          title="previous chapter">Using the Integrate module</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="UsingRCW.html"
                          title="next chapter">Using the RCW module</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/UsingScatterer.ipynb.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="UsingRCW.html" title="Using the RCW module"
             >next</a> |</li>
        <li class="right" >
          <a href="UsingIntegrate.html" title="Using the Integrate module"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pySCATMECH 0.1.9 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Using the Scatterer module</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.1.1.
    </div>
  </body>
</html>