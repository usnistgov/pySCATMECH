
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Using the Mueller module &#8212; pySCATMECH 0.1.7 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/nature.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Using the Fresnel module" href="UsingFresnel.html" />
    <link rel="prev" title="pySCATMECH : A Python Interface to the SCATMECH Library" href="index.html" />
<link rel="stylesheet" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css">
  <script src="https://code.jquery.com/jquery-1.12.4.min.js" type="text/javascript"></script>
  <script src="https://pages.nist.gov/nist-header-footer/js/nist-header-footer.js" type="text/javascript" defer="defer"></script>

<script async type="text/javascript" id="_fed_an_ua_tag" src="https://dap.digitalgov.gov/Universal-Federated-Analytics-Min.js?agency=NIST&subagency=github&pua=UA-66610693-1&yt=true&exts=ppsx,pps,f90,sch,rtf,wrl,txz,m1v,xlsm,msi,xsd,f,tif,eps,mpg,xml,pl,xlt,c">
</script>

  
<script type="text/javascript" src="https://pages.nist.gov/leaveNotice/js/jquery.leaveNotice-nist.min.js"></script>
<script>
$(document).ready(function(){
  // Mark external (non-nist.gov) A tags with class "external"
  //If the adress start with https and ends with nist.gov
  var re_nist = new RegExp('^https?:\/\/((^\/)*\.)*nist\\.gov(\/|$)');
  //Regex to find address that start with https
  var re_absolute_address = new RegExp('^((https?:)?\/\/)');
  $("a").each(function(){
    var url=$(this).attr('href');
    if(re_nist.test(url) || !re_absolute_address.test(url)){
      $(this).addClass('local');
    }else{
      //This a href appears to be external, so tag it
      $(this).addClass('external');
    }
  });
  // Add leaveNotice to external A elements
  $('a.external').leaveNotice();
});
</script>
<link rel="stylesheet" type="text/css" href="https://pages.nist.gov/leaveNotice/css/jquery.leaveNotice.css" />


  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="UsingFresnel.html" title="Using the Fresnel module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="pySCATMECH : A Python Interface to the SCATMECH Library"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pySCATMECH 0.1.7 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Using the Mueller module</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<section id="Using-the-Mueller-module">
<h1>Using the Mueller module<a class="headerlink" href="#Using-the-Mueller-module" title="Permalink to this heading">¶</a></h1>
<p>In this notebook, we demonstrate how to use the Mueller module, which defines the <code class="docutils literal notranslate"><span class="pre">MuellerMatrix</span></code> and <code class="docutils literal notranslate"><span class="pre">StokesVector</span></code> classes and various operations on them.</p>
<p>The first thing, of course, is to import the package and some other packages that we will be using. We will be creating some random matrices and vectors, so we need <code class="docutils literal notranslate"><span class="pre">random</span></code>, and we will be graphing a few things, so we need <code class="docutils literal notranslate"><span class="pre">maptplotlib.pyplot</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pySCATMECH.mueller</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
<section id="Mueller-matrices">
<h2>Mueller matrices<a class="headerlink" href="#Mueller-matrices" title="Permalink to this heading">¶</a></h2>
<p>The class <code class="docutils literal notranslate"><span class="pre">MuellerMatrix</span></code> is used for handling Mueller matrices. Here we show several ways one can create a unit Mueller matrix. The <code class="docutils literal notranslate"><span class="pre">JonesMueller()</span></code> function converts a 2 x 2 complex Jones matrix into a Mueller matrix. And <code class="docutils literal notranslate"><span class="pre">MuellerUnit()</span></code> returns a unit Mueller matrix.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m1</span> <span class="o">=</span> <span class="n">MuellerMatrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">m2</span> <span class="o">=</span> <span class="n">MuellerMatrix</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">m3</span> <span class="o">=</span> <span class="n">MuellerMatrix</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">m4</span> <span class="o">=</span> <span class="n">JonesMueller</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">m5</span> <span class="o">=</span> <span class="n">MuellerUnit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[1. 0. 0. 0.]
 [0. 1. 0. 0.]
 [0. 0. 1. 0.]
 [0. 0. 0. 1.]]
</pre></div></div>
</div>
<p>We can check to see that these are valid matrices. The <code class="docutils literal notranslate"><span class="pre">valid</span></code> method tests whether a Mueller matrix maps the set of valid Stokes vectors onto itself. The <code class="docutils literal notranslate"><span class="pre">physically_valid</span></code> method tests whether a Mueller matrix is a convex sum of Jones-Mueller matrices. The latter is a more stringent test of whether the matrix is realizable.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">m1</span><span class="o">.</span><span class="n">valid</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m1</span><span class="o">.</span><span class="n">physically_valid</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
True
</pre></div></div>
</div>
<p>But, a random matrix is not necessarily valid. In fact, it probably isn’t!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Returns a random number with a normal distribution...</span>
<span class="n">ran</span> <span class="o">=</span> <span class="k">lambda</span> <span class="p">:</span> <span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Create 20 random matrices...</span>
<span class="n">m1</span> <span class="o">=</span> <span class="p">[</span><span class="n">MuellerMatrix</span><span class="p">([[</span><span class="n">ran</span><span class="p">(),</span> <span class="n">ran</span><span class="p">(),</span> <span class="n">ran</span><span class="p">(),</span> <span class="n">ran</span><span class="p">()],</span>
                    <span class="p">[</span><span class="n">ran</span><span class="p">(),</span> <span class="n">ran</span><span class="p">(),</span> <span class="n">ran</span><span class="p">(),</span> <span class="n">ran</span><span class="p">()],</span>
                    <span class="p">[</span><span class="n">ran</span><span class="p">(),</span> <span class="n">ran</span><span class="p">(),</span> <span class="n">ran</span><span class="p">(),</span> <span class="n">ran</span><span class="p">()],</span>
                    <span class="p">[</span><span class="n">ran</span><span class="p">(),</span> <span class="n">ran</span><span class="p">(),</span> <span class="n">ran</span><span class="p">(),</span> <span class="n">ran</span><span class="p">()]])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>

<span class="c1"># See if they are valid...</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number valid() is True:&quot;</span><span class="p">,</span> <span class="nb">sum</span><span class="p">([</span><span class="n">m</span><span class="o">.</span><span class="n">valid</span><span class="p">()</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">m1</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number physically valid() is True:&quot;</span><span class="p">,</span> <span class="nb">sum</span><span class="p">([</span><span class="n">m</span><span class="o">.</span><span class="n">physically_valid</span><span class="p">()</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">m1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number valid() is True: 1
Number physically valid() is True: 0
</pre></div></div>
</div>
<p>A Mueller matrix made from a random Jones matrix, however, always yields a valid Mueller matrix.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Returns a random complex number with a normal distribution...</span>
<span class="n">ranc</span> <span class="o">=</span> <span class="k">lambda</span> <span class="p">:</span> <span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span>

<span class="c1"># Create 20 random Jones-Mueller matrices...</span>
<span class="n">m1</span> <span class="o">=</span> <span class="p">[</span><span class="n">JonesMueller</span><span class="p">([[</span><span class="n">ranc</span><span class="p">(),</span> <span class="n">ranc</span><span class="p">()],</span> <span class="p">[</span><span class="n">ranc</span><span class="p">(),</span> <span class="n">ranc</span><span class="p">()]])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>

<span class="c1"># See if they are valid...</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number value() is True:&quot;</span><span class="p">,</span> <span class="nb">sum</span><span class="p">([</span><span class="n">m</span><span class="o">.</span><span class="n">valid</span><span class="p">()</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">m1</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number physically valid() is True:&quot;</span><span class="p">,</span> <span class="nb">sum</span><span class="p">([</span><span class="n">m</span><span class="o">.</span><span class="n">physically_valid</span><span class="p">()</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">m1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number value() is True: 20
Number physically valid() is True: 20
</pre></div></div>
</div>
<p>To make a random depolarizing Mueller matrix, we average some random Jones-Mueller matrices:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">RandomMuellerMatrix</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a random Mueller matrix by averaging `n` Jones-Mueller matrices.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ranc</span> <span class="o">=</span> <span class="k">lambda</span> <span class="p">:</span> <span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">([</span><span class="n">JonesMueller</span><span class="p">([[</span><span class="n">ranc</span><span class="p">(),</span><span class="n">ranc</span><span class="p">()],[</span><span class="n">ranc</span><span class="p">(),</span><span class="n">ranc</span><span class="p">()]])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)])</span><span class="o">/</span><span class="n">n</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">RandomMuellerMatrix</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m is a valid Stokes to Stokes mapper:&quot;</span><span class="p">,</span><span class="n">m</span><span class="o">.</span><span class="n">valid</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m is the sum of Jones-Mueller matrices:&quot;</span><span class="p">,</span><span class="n">m</span><span class="o">.</span><span class="n">physically_valid</span><span class="p">())</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[ 0.79126519  0.51754966  0.04396498 -0.09197144]
 [-0.21857972 -0.10891561  0.03399935  0.04409256]
 [ 0.24109773  0.27199561  0.06684414 -0.02241909]
 [ 0.31260027  0.21946993  0.16903187 -0.02210762]]
m is a valid Stokes to Stokes mapper: True
m is the sum of Jones-Mueller matrices: True
</pre></div></div>
</div>
</section>
<section id="Stokes-Vectors">
<h2>Stokes Vectors<a class="headerlink" href="#Stokes-Vectors" title="Permalink to this heading">¶</a></h2>
<p>The class <code class="docutils literal notranslate"><span class="pre">StokesVector</span></code> is used for handling Stokes vectors. We can create a Stokes vector a several ways. The <code class="docutils literal notranslate"><span class="pre">Polarization</span></code> function provides a means for generating arbitrary polarizations by name or parameter. (Note that SCATMECH’s convention for the signs of the Stokes vector elements differs from some others.)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unpolarized Stokes vector:&quot;</span><span class="p">,</span> <span class="n">StokesVector</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span> <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unpolarized Stokes vector:&quot;</span><span class="p">,</span> <span class="n">StokesVector</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;s-polarized unit polarization from a Jones vector:&quot;</span><span class="p">,</span> <span class="n">JonesStokes</span><span class="p">((</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">))</span> <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;p-polarized unit Stokes vector:&quot;</span><span class="p">,</span> <span class="n">Polarization</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span> <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;s-polarized unit Stokes vector:&quot;</span><span class="p">,</span> <span class="n">Polarization</span><span class="p">(</span><span class="n">state</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span> <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Left-handed circularly polarized unit Stokes vector:&quot;</span><span class="p">,</span> <span class="n">Polarization</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">)</span> <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Right-handed circularly polarized unit Stokes vector with intensity 2:&quot;</span><span class="p">,</span> <span class="n">Polarization</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">,</span> <span class="n">I</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unpolarized Stokes vector:&quot;</span><span class="p">,</span> <span class="n">Polarization</span><span class="p">(</span><span class="s2">&quot;U&quot;</span><span class="p">)</span> <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unpolarized Stokes vector:&quot;</span><span class="p">,</span> <span class="n">Polarization</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">DOP</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Linear polarization at 45 degrees:&quot;</span><span class="p">,</span> <span class="n">Polarization</span><span class="p">(</span><span class="n">angle</span> <span class="o">=</span> <span class="mi">45</span><span class="o">*</span><span class="n">deg</span><span class="p">)</span> <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Elliptically polarized radiation:&quot;</span><span class="p">,</span> <span class="n">Polarization</span><span class="p">(</span><span class="n">angle</span> <span class="o">=</span> <span class="mi">34</span><span class="o">*</span><span class="n">deg</span><span class="p">,</span> <span class="n">ellipticity</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">deg</span><span class="p">)</span> <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Partially polarized radiation:&quot;</span><span class="p">,</span> <span class="n">Polarization</span><span class="p">(</span><span class="s2">&quot;S&quot;</span><span class="p">,</span> <span class="n">DOP</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">)</span> <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Partially polarized elliptical polarized radiation with intensity 3:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">Polarization</span><span class="p">(</span><span class="n">angle</span> <span class="o">=</span> <span class="mi">34</span><span class="o">*</span><span class="n">deg</span><span class="p">,</span> <span class="n">ellipticity</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">deg</span><span class="p">,</span> <span class="n">DOP</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span> <span class="n">I</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Unpolarized Stokes vector: StokesVector(1,0,0,0)
Unpolarized Stokes vector: StokesVector(1,0,0,0)
s-polarized unit polarization from a Jones vector: StokesVector(1.0,1.0,0.0,0.0)
p-polarized unit Stokes vector: StokesVector(1,-1,0,0)
s-polarized unit Stokes vector: StokesVector(1,1,0,0)
Left-handed circularly polarized unit Stokes vector: StokesVector(1,0,0,1)
Right-handed circularly polarized unit Stokes vector with intensity 2: StokesVector(2,0,0,-2)
Unpolarized Stokes vector: StokesVector(1,0,0,0)
Unpolarized Stokes vector: StokesVector(1,0,0,0)
Linear polarization at 45 degrees: StokesVector(1.0,6.123233995736766e-17,1.0,0.0)
Elliptically polarized radiation: StokesVector(1.0,0.2869652992419897,0.7102640395405222,0.6427876096865393)
Partially polarized radiation: StokesVector(1.0,0.8,0.0,0.0)
Partially polarized elliptical polarized radiation with intensity 3:
 StokesVector(3.0,0.6026271284081782,1.4915544830350964,1.3498539803417322)
</pre></div></div>
</div>
<p>Note that polarization sensitivity can also be expressed as a Stokes vector. However, there is often a factor of two that enters for all but unpolarized sensitivity. That is, a perfect polarizer transmits 50 % of unpolarized radiation. We can apply <code class="docutils literal notranslate"><span class="pre">senstivity</span> <span class="pre">=</span> <span class="pre">True</span></code> to the <code class="docutils literal notranslate"><span class="pre">Polarization()</span></code> function, or use a <code class="docutils literal notranslate"><span class="pre">Sensitivity</span></code> function.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Only sensitive to p-polarization</span>
<span class="c1"># The following two statements are equivalent...</span>
<span class="n">sens</span> <span class="o">=</span> <span class="n">Polarization</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="n">sensitivity</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">sens</span> <span class="o">=</span> <span class="n">Sensitivity</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Signal for p-polarization:&#39;</span><span class="p">,</span><span class="n">sens</span> <span class="o">@</span> <span class="n">Polarization</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Signal for s-polarization:&#39;</span><span class="p">,</span><span class="n">sens</span> <span class="o">@</span> <span class="n">Polarization</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">))</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Signal for p-polarization: 1.0
Signal for s-polarization: 0.0
</pre></div></div>
</div>
<p>Sensitivity does not need to be full polarizing. By setting <code class="docutils literal notranslate"><span class="pre">DOP</span></code> in the range [0,1], sensitivity to the orthogonal polarization can be non-zero.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sens</span> <span class="o">=</span> <span class="n">Sensitivity</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">,</span><span class="n">DOP</span><span class="o">=</span><span class="mf">.8</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;sens = &#39;</span><span class="p">,</span> <span class="n">sens</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Signal for p-polarization:&#39;</span><span class="p">,</span><span class="n">sens</span> <span class="o">@</span> <span class="n">Polarization</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Signal for s-polarization:&#39;</span><span class="p">,</span><span class="n">sens</span> <span class="o">@</span> <span class="n">Polarization</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
sens =  StokesVector(0.6,-0.4,0.0,0.0)
Signal for p-polarization: 1.0
Signal for s-polarization: 0.19999999999999996
</pre></div></div>
</div>
<p>In a manner similar to what we did with Mueller matrices, we can create a random Stokes vector by averaging a number of Stokes vectors created from Jones vectors. For a single Jones vector, the Stokes vector is depolarized. For more than one, the Stokes vector is partially polarized or unpolarized. We illustrate that by plotting the degree of polarization (using the <code class="docutils literal notranslate"><span class="pre">DOP()</span></code> method) as a function of the number of Jones-Stokes vectors we add.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">RandomStokesVector</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">ranc</span> <span class="o">=</span> <span class="k">lambda</span> <span class="p">:</span> <span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">([</span><span class="n">JonesStokes</span><span class="p">([</span><span class="n">ranc</span><span class="p">(),</span><span class="n">ranc</span><span class="p">()])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)])</span><span class="o">/</span><span class="n">n</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">),[</span><span class="n">RandomStokesVector</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">DOP</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">)])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Degree of polarization vs. number of Jones-Stokes vectors&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;n&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Degree of polarization&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="Graph showing results of preceding Python code: Noisy curve starting at 1 and decaying to a level of between about 0.1 and 0.2." src="_images/UsingMueller_20_0.svg" /></div>
</div>
<p>We can multiply Mueller matrices and Stokes vectors. You can use the <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> or <code class="docutils literal notranslate"><span class="pre">*</span></code> operators or the <code class="docutils literal notranslate"><span class="pre">dot()</span></code> function to multiply the objects. If a Stokes vector multiplies a Mueller matrix from the left, it is assumed to be transposed first. The product of two Stokes vectors is the inner product, a scalar.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m1</span> <span class="o">=</span> <span class="n">RandomMuellerMatrix</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">m2</span> <span class="o">=</span> <span class="n">RandomMuellerMatrix</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">s1</span> <span class="o">=</span> <span class="n">RandomStokesVector</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">RandomStokesVector</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m1 = </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">m1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m2 = </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">m2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;s1 = &quot;</span><span class="p">,</span><span class="n">s1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;s2 = &quot;</span><span class="p">,</span><span class="n">s2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m1 * s1 = &quot;</span><span class="p">,</span><span class="n">m1</span> <span class="o">*</span> <span class="n">s1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m1 @ s1 = &quot;</span><span class="p">,</span><span class="n">m1</span> <span class="o">*</span> <span class="n">s1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m1.dot(s1) = &quot;</span><span class="p">,</span><span class="n">m1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">s1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m1 @ m2 = &quot;</span><span class="p">,</span><span class="n">m1</span> <span class="o">*</span> <span class="n">m2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;s1 @ m1 = &quot;</span><span class="p">,</span><span class="n">s1</span> <span class="o">*</span> <span class="n">m1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;s1 @ s2 = &quot;</span><span class="p">,</span><span class="n">s1</span> <span class="o">*</span> <span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
m1 =
 [[ 0.94335668 -0.16250793  0.46915549 -0.14212114]
 [-0.23542067  0.62314123 -0.18648852 -0.05825565]
 [-0.01326436 -0.06702373  0.02740091 -0.4182326 ]
 [ 0.37937625 -0.06489837  0.54109253  0.07621696]]
m2 =
 [[ 0.90393586  0.42883859  0.05893816 -0.0398583 ]
 [-0.03255312 -0.05484299  0.28021642  0.20824843]
 [ 0.17437584  0.3752689  -0.03803409  0.08744445]
 [ 0.35288836  0.34723155  0.26526746 -0.43082467]]
s1 =  StokesVector(1.2205852882966242,-0.07508395251618234,0.8002605801487375,-0.2529729329906206)
s2 =  StokesVector(1.5964694635032322,-0.2407997868272278,0.5994372371241194,-0.8510075390636394)
m1 * s1 =  StokesVector(1.5750484699343372,-0.46864121761363126,0.11657152710872415,0.8816680960253582)
m1 @ s1 =  StokesVector(1.5750484699343372,-0.46864121761363126,0.11657152710872415,0.8816680960253582)
m1.dot(s1) =  [ 1.57504847 -0.46864122  0.11657153  0.8816681 ]
m1 @ m2 =  [[ 0.88968056  0.54017069 -0.0454817   0.03081172]
 [-0.28616721 -0.22534394  0.15237873  0.14794223]
 [-0.15261965 -0.13695333 -0.13154859  0.16915209]
 [ 0.46629398  0.39577053  0.00381207 -0.01415688]]
s1 @ m1 =  StokesVector(1.062536738150666,-0.2823616179668839,0.4716926877767631,-0.5230727916610801)
s1 @ s2 =  2.661695204424655
</pre></div></div>
</div>
</section>
<section id="Mueller-matrix-decompositions">
<h2>Mueller matrix decompositions<a class="headerlink" href="#Mueller-matrix-decompositions" title="Permalink to this heading">¶</a></h2>
<p>So, now that we can create some physically valid Mueller matrices, we can explore some decompositions. The Cloude decomposition* decomposes a Mueller matrix into an incoherent, positive (convex) sum of Jones-Mueller matrices.</p>
<p>*S. R. Cloude, “Group theory and polarization algebra,” Optik (Stuttgart) <strong>75</strong>, 26–36 (1986) and S. R. Cloude and E. Pottier, “A review of target decomposition theorems in radar polarimetry,” IEEE Trans. Geosci. and Remote Sensing 34, 498–518 (1996).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M</span> <span class="o">=</span> <span class="n">RandomMuellerMatrix</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">MCD</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">Cloude_Decomposition</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;M = </span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Cloude decomposition =</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">MCD</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Purity1 = </span><span class="si">{</span><span class="p">(</span><span class="n">MCD</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">MCD</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Purity2 = </span><span class="si">{</span><span class="p">(</span><span class="n">MCD</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">MCD</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">MCD</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Purity3 = </span><span class="si">{</span><span class="p">(</span><span class="n">MCD</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">MCD</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">MCD</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">MCD</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M =

 [[ 0.97198146  0.30841196 -0.13263167  0.11331983]
 [-0.01312405  0.05122653  0.24274521  0.03582365]
 [-0.14679568  0.04987054 -0.08064983 -0.34434852]
 [-0.09716448 -0.16663341 -0.09086824  0.40486368]]

Cloude decomposition =

[[ 0.49815716  0.23393238 -0.05659197  0.11395561]
 [-0.07926307 -0.06762069  0.42302718  0.00239692]
 [-0.22600176 -0.30168327 -0.00377822 -0.37053662]
 [-0.11641932 -0.36930565 -0.03852329  0.2300661 ]]

[[ 0.31877226  0.15566403 -0.09501666  0.02225629]
 [ 0.10148151  0.03766427 -0.2769091   0.00788727]
 [ 0.13742785  0.28393391 -0.01393898 -0.07703643]
 [ 0.06760094  0.10027555 -0.0040224   0.2497188 ]]

[[ 0.15220157 -0.07995128  0.01814329 -0.02246167]
 [-0.03555445  0.08268129  0.09841471  0.02611275]
 [-0.05939849  0.06973868 -0.06428279  0.10233195]
 [-0.04933165  0.10311127 -0.04950611 -0.07273397]]

[[ 0.00285046 -0.00123317  0.00083367 -0.0004304 ]
 [ 0.00021197 -0.00149834 -0.00178758 -0.00057329]
 [ 0.00117673 -0.00211878  0.00135016  0.00089258]
 [ 0.00098556 -0.00071458  0.00118356 -0.00218725]]

Purity1 = 0.18455587955678526
Purity2 = 0.527300463403825
Purity3 = 0.9882694784032228
</pre></div></div>
</div>
<p>Notice that if we create the random Mueller matrix from less than four Jones-Mueller matrices, the Cloude decomposition will have only as many non-zero matrices as there were Jones-Mueller matrices. In the following, we plot the average magnitude of each element of the Cloude decomposition as a function of how many Jones-Mueller matrices were added.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jmax</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">imax</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">mCD00sums</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">imax</span><span class="p">):</span>
    <span class="n">mCD00sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">jmax</span><span class="p">):</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">RandomMuellerMatrix</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">mCD</span> <span class="o">=</span> <span class="n">Cloude_Decomposition</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
        <span class="n">mCD00sum</span> <span class="o">=</span> <span class="n">mCD00sum</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">mCD</span><span class="p">])</span>
    <span class="n">mCD00sums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mCD00sum</span><span class="o">/</span><span class="n">jmax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mCD00sums</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Number of Jones-Mueller matrices averaged&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Cloude decomposition&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="Graph showing results of preceding Python code: Four curves starting, one starting at 1 and decaying to about 0.35 and threestarting at 0 and rising to levels around about 0.25." src="_images/UsingMueller_26_0.svg" /></div>
</div>
<p>The Lu-Chipman decomposition* decomposes a given Mueller matrix <span class="math notranslate nohighlight">\(\mathbf{M}\)</span> into the ordered product of three matrices:</p>
<div class="math notranslate nohighlight">
\[\mathbf{M} = \mathbf{M}_\Delta \mathbf{M}_R \mathbf{M}_D\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{M}_\Delta\)</span> is a depolarizer, <span class="math notranslate nohighlight">\(\mathbf{M}_R\)</span> is a retarder, and <span class="math notranslate nohighlight">\(\mathbf{M}_D\)</span> is a diattenuator. Notice that if there is only one Jones-Mueller matrix used to create the random matrix, there will be no depolarization.</p>
<p>*S.-Y. Lu and R. A. Chipman, “Interpretation of Mueller matrices based on polar decomposition,” J. Opt. Soc. Am. A 13, 1106–1113 (1996)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">printMatrix</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">M</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="s2">&quot;=</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">RandomMuellerMatrix</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">depol</span><span class="p">,</span> <span class="n">ret</span><span class="p">,</span> <span class="n">diatten</span> <span class="o">=</span> <span class="n">Lu_Chipman_Decomposition</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;M&quot;</span><span class="p">,</span><span class="n">M</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;Depolarizer&quot;</span><span class="p">,</span><span class="n">depol</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;Retarder&quot;</span><span class="p">,</span><span class="n">ret</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;Diattenuator&quot;</span><span class="p">,</span><span class="n">diatten</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;The product Depolarizer . Retarder .  Diattenuator&quot;</span><span class="p">,</span><span class="n">depol</span> <span class="o">@</span> <span class="n">ret</span> <span class="o">@</span> <span class="n">diatten</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

 M =

[[ 0.84442092  0.1075449   0.06352588  0.05409045]
 [ 0.21973306  0.44426721 -0.13529821  0.11410266]
 [ 0.23420748  0.03277545 -0.11947241 -0.13426277]
 [ 0.08729154  0.07995964 -0.03015655 -0.0153505 ]]

 Depolarizer =

[[1.         0.         0.         0.        ]
 [0.20185409 0.54228623 0.00714284 0.07993953]
 [0.30106685 0.00714284 0.24083235 0.04079128]
 [0.09770437 0.07993953 0.04079128 0.03708036]]

 Retarder =

[[ 1.00000000e+00  2.10335221e-17 -1.89193279e-17  0.00000000e+00]
 [ 1.11022302e-16  8.54280664e-01 -3.97300271e-01  3.35197020e-01]
 [ 4.44089210e-16 -1.03253526e-01 -7.61690669e-01 -6.39660874e-01]
 [ 0.00000000e+00  5.09453881e-01  5.11839642e-01 -6.91720264e-01]]

 Diattenuator =

[[0.84442092 0.1075449  0.06352588 0.05409045]
 [0.1075449  0.84027184 0.00407193 0.00346713]
 [0.06352588 0.00407193 0.8357836  0.00204801]
 [0.05409045 0.00346713 0.00204801 0.83512216]]

 The product Depolarizer . Retarder .  Diattenuator =

[[ 0.84442092  0.1075449   0.06352588  0.05409045]
 [ 0.21973306  0.44426721 -0.13529821  0.11410266]
 [ 0.23420748  0.03277545 -0.11947241 -0.13426277]
 [ 0.08729154  0.07995964 -0.03015655 -0.0153505 ]]
</pre></div></div>
</div>
<p>The reverse Lu-Chipman decomposition is similar to the Lu-Chipman decomposition, except that the order of the elements us reversed. That is,</p>
<div class="math notranslate nohighlight">
\[\mathbf{M} = \mathbf{M}^\prime_D \mathbf{M}^\prime_R  \mathbf{M}^\prime_\Delta\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{M}^\prime_D\)</span> is a diattenuator, <span class="math notranslate nohighlight">\(\mathbf{M}^\prime_R\)</span> is a retarder, and <span class="math notranslate nohighlight">\(\mathbf{M}^\prime_\Delta\)</span> is a depolarizer. Note that highly depolarizing Mueller matrices often cannot be decomposed in this fashion, an exception will be thrown if this is the case.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M</span> <span class="o">=</span> <span class="n">RandomMuellerMatrix</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">diatten</span><span class="p">,</span> <span class="n">ret</span><span class="p">,</span> <span class="n">depol</span> <span class="o">=</span> <span class="n">Reverse_Lu_Chipman_Decomposition</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;M&quot;</span><span class="p">,</span><span class="n">M</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;Diattenuator&quot;</span><span class="p">,</span><span class="n">diatten</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;Retarder&quot;</span><span class="p">,</span><span class="n">ret</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;Depolarizer&quot;</span><span class="p">,</span><span class="n">depol</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;The product Diattenuator . Retarder .  Depolarizer&quot;</span><span class="p">,</span> <span class="n">diatten</span> <span class="o">@</span> <span class="n">ret</span> <span class="o">@</span> <span class="n">depol</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

 M =

[[ 0.79050245  0.31080475  0.13624337 -0.2012983 ]
 [-0.22657717 -0.64638751 -0.16880211 -0.25056315]
 [ 0.19461597  0.0578249   0.53578195 -0.31627667]
 [ 0.17512845  0.33887398 -0.24140583 -0.45722454]]

 Diattenuator =

[[ 0.87059006 -0.230308    0.2884748   0.30995087]
 [-0.230308    0.75822452 -0.04163903 -0.04473893]
 [ 0.2884748  -0.04163903  0.77713682  0.05603824]
 [ 0.30995087 -0.04473893  0.05603824  0.78519151]]

 Retarder =

[[ 1.          0.          0.          0.        ]
 [ 0.         -0.87883829 -0.22590361 -0.4202509 ]
 [ 0.          0.01769794  0.86476707 -0.50186123]
 [ 0.          0.4767914  -0.44849244 -0.75599239]]

 Depolarizer =

[[ 1.          0.          0.          0.        ]
 [-0.07088282  0.91237903  0.01709567  0.05714633]
 [-0.01846463  0.01709567  0.82188915  0.01194215]
 [ 0.18385422  0.05714633  0.01194215  0.79183899]]

 The product Diattenuator . Retarder .  Depolarizer =

[[ 0.79050245  0.31080475  0.13624337 -0.2012983 ]
 [-0.22657717 -0.64638751 -0.16880211 -0.25056315]
 [ 0.19461597  0.0578249   0.53578195 -0.31627667]
 [ 0.17512845  0.33887398 -0.24140583 -0.45722454]]
</pre></div></div>
</div>
<p>The symmetric decomposition, introduced by Ossikovski,* is a decomposition that treats the ordering of the Mueller matrix product as symmetric. That is, the Mueller matrix <span class="math notranslate nohighlight">\(\mathbf{M}\)</span> is decomposed into</p>
<div class="math notranslate nohighlight">
\[\mathbf{M} = \mathbf{M}_{D_2} \mathbf{M}_{R_2}  \mathbf{M}_\Delta \mathbf{M}_{R_1} \mathbf{M}_{D_1}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{M}_{D_1}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{M}_{D_2}\)</span> are a diattenuators, <span class="math notranslate nohighlight">\(\mathbf{M}^\prime_{R_1}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{M}^\prime_{R_2}\)</span> are retarders, and <span class="math notranslate nohighlight">\(\mathbf{M}_\Delta\)</span> is a diagonal depolarizer.</p>
<p>*R. Ossikovski, “Analysis of depolarizing Mueller matrices through a symmetric decomposition,” J. Opt. Soc. Am. A, 26(5), 1109-1118 (2009).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M</span> <span class="o">=</span> <span class="n">RandomMuellerMatrix</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">diatten2</span><span class="p">,</span> <span class="n">ret2</span><span class="p">,</span> <span class="n">depol</span><span class="p">,</span> <span class="n">ret1</span><span class="p">,</span> <span class="n">diatten1</span> <span class="o">=</span> <span class="n">Symmetric_Decomposition</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;M&quot;</span><span class="p">,</span><span class="n">M</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;diatten2&quot;</span><span class="p">,</span><span class="n">diatten2</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;ret2&quot;</span><span class="p">,</span><span class="n">ret2</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;depol&quot;</span><span class="p">,</span><span class="n">depol</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;ret1&quot;</span><span class="p">,</span><span class="n">ret1</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;diatten1&quot;</span><span class="p">,</span><span class="n">diatten1</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;The product Diattenuator2 . Retarder2 .  Depolarizer . Retarder1 . Diattenuator1&quot;</span><span class="p">,</span>
            <span class="n">diatten2</span> <span class="o">@</span> <span class="n">ret2</span> <span class="o">@</span> <span class="n">depol</span> <span class="o">@</span> <span class="n">ret1</span> <span class="o">@</span> <span class="n">diatten1</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

 M =

[[ 1.31346355 -0.70433204 -0.05792289 -0.42159147]
 [-0.59531681  0.30343934 -0.47341912  0.52095325]
 [ 0.31783609 -0.24582591 -0.39663839  0.37667674]
 [ 0.27500732 -0.26594446  0.04012768 -0.18661019]]

 diatten2 =

[[ 1.         -0.42564353  0.31261478  0.10704983]
 [-0.42564353  0.94073622 -0.0722223  -0.02473135]
 [ 0.31261478 -0.0722223   0.8954451   0.01816399]
 [ 0.10704983 -0.02473135  0.01816399  0.84862125]]

 ret2 =

[[ 1.          0.          0.          0.        ]
 [ 0.          0.70579373 -0.26909955  0.6553172 ]
 [ 0.          0.69389627  0.44894296 -0.56299039]
 [ 0.         -0.14269958  0.85207726  0.5035883 ]]

 depol =

[[1.31231491 0.         0.         0.        ]
 [0.         1.31231491 0.         0.        ]
 [0.         0.         0.24752227 0.        ]
 [0.         0.         0.         0.24752227]]

 ret1 =

[[ 1.          0.          0.          0.        ]
 [ 0.         -0.01944212 -0.73046083  0.6826778 ]
 [ 0.         -0.9627385   0.19788894  0.18432186]
 [ 0.         -0.26973428 -0.65365659 -0.70709015]]

 diatten1 =

[[ 1.         -0.50453294 -0.15004366 -0.31959462]
 [-0.50453294  0.93027935  0.04234118  0.09018718]
 [-0.15004366  0.04234118  0.80049588  0.02682087]
 [-0.31959462  0.09018718  0.02682087  0.84503274]]

 The product Diattenuator2 . Retarder2 .  Depolarizer . Retarder1 . Diattenuator1 =

[[ 1.31346355 -0.70433204 -0.05792289 -0.42159147]
 [-0.59531681  0.30343934 -0.47341912  0.52095325]
 [ 0.31783609 -0.24582591 -0.39663839  0.37667674]
 [ 0.27500732 -0.26594446  0.04012768 -0.18661019]]
</pre></div></div>
</div>
<p>The differential decomposition is simply the matrix logarithm of the Mueller matrix.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M</span> <span class="o">=</span> <span class="n">RandomMuellerMatrix</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">MuellerLog</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;M&quot;</span><span class="p">,</span><span class="n">M</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">,</span><span class="n">L</span><span class="p">)</span>
<span class="n">printMatrix</span><span class="p">(</span><span class="s2">&quot;MuellerExp(L)&quot;</span><span class="p">,</span><span class="n">MuellerExp</span><span class="p">(</span><span class="n">L</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

 M =

[[ 0.90254645  0.27385362  0.30832524 -0.28841948]
 [-0.32530387 -0.31270702 -0.36702936 -0.22067358]
 [-0.10609641 -0.01203455 -0.22551256  0.15574008]
 [-0.40125467 -0.27026781 -0.04613747  0.37130898]]

 L =

[[-0.28858548  0.16185659  0.85000633 -0.74234137]
 [-1.10744528 -2.89640883 -6.81363824  0.49688726]
 [ 0.53841303  1.40068116  0.37418308  0.5630028 ]
 [-1.01346942 -0.95694393 -2.34927816 -0.91739108]]

 MuellerExp(L) =

[[ 0.90254645  0.27385362  0.30832524 -0.28841948]
 [-0.32530387 -0.31270702 -0.36702936 -0.22067358]
 [-0.10609641 -0.01203455 -0.22551256  0.15574008]
 [-0.40125467 -0.27026781 -0.04613747  0.37130898]]
</pre></div></div>
</div>
</section>
<section id="Other-parameters">
<h2>Other parameters<a class="headerlink" href="#Other-parameters" title="Permalink to this heading">¶</a></h2>
<p>One can obtain other parameters associated with a Mueller matrix.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M</span> <span class="o">=</span> <span class="n">RandomMuellerMatrix</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tmax = &quot;</span><span class="p">,</span><span class="n">M</span><span class="o">.</span><span class="n">Tmax</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tmin = &quot;</span><span class="p">,</span><span class="n">M</span><span class="o">.</span><span class="n">Tmin</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;diattenuation = &quot;</span><span class="p">,</span><span class="n">M</span><span class="o">.</span><span class="n">diattenuation</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;linear diattenuation = &quot;</span><span class="p">,</span><span class="n">M</span><span class="o">.</span><span class="n">linear_diattenuation</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;polarization dependent loss = &quot;</span><span class="p">,</span><span class="n">M</span><span class="o">.</span><span class="n">polarization_dependent_loss</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;polarizance = &quot;</span><span class="p">,</span><span class="n">M</span><span class="o">.</span><span class="n">polarizance</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;depolarization index = &quot;</span><span class="p">,</span><span class="n">M</span><span class="o">.</span><span class="n">depolarization_index</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;extinction_ratio = &quot;</span><span class="p">,</span><span class="n">M</span><span class="o">.</span><span class="n">extinction_ratio</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Tmax =  1.1130487259621076
Tmin =  0.3550748776407327
diattenuation =  0.5162874886428319
linear diattenuation =  0.5008220205047619
polarization dependent loss =  4.961942308101194
polarizance =  0.5633462437213892
depolarization index =  0.6589112048969448
extinction_ratio =  3.1346873463920426
</pre></div></div>
</div>
<p>There is also a class <code class="docutils literal notranslate"><span class="pre">CharacterizedMueller</span></code> that performs a Lu-Chipman decomposition and extracts parameters from them. This is treated as a separate class, because initialization performs the decomposition, assigning values to the parameters. Note that the parameters differ from those shown above, due to differences in definition.</p>
<ol class="upperalpha simple" start="14">
<li><p>Ghosh, M.F.G. Wood, and I.A. Vitkin, ‘’Mueller matrix decomposition for extraction of individual polarization parameters from complex turbid media exhibiting multiple scattering, optical activity, and linear birefringence,’’ J. Biomedical Opt. 13, 044036 (2008).</p></li>
</ol>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">parametersM</span> <span class="o">=</span> <span class="n">CharacterizedMueller</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">parametersM</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Mdepol =
[[ 1.          0.          0.          0.        ]
 [-0.08476877  0.27377418 -0.03728996  0.09656993]
 [-0.20204637 -0.03728996  0.44373316 -0.09981802]
 [-0.26307903  0.09656993 -0.09981802  0.59248849]]
Mret =
[[ 1.00000000e+00 -9.45424294e-17 -7.28583860e-17 -5.55111512e-17]
 [ 0.00000000e+00 -5.62772927e-01 -5.92775720e-01 -5.76110734e-01]
 [-1.24900090e-16 -3.11903969e-01  7.97714968e-01 -5.16107299e-01]
 [ 5.55111512e-17  7.65508031e-01 -1.10759990e-01 -6.33821488e-01]]
Mdiatten =
[[ 0.7340618  -0.34245359  0.13371808  0.09206573]
 [-0.34245359  0.71472066 -0.03360347 -0.0231362 ]
 [ 0.13371808 -0.03360347  0.64178295  0.00903401]
 [ 0.09206573 -0.0231362   0.00903401  0.63488175]]
DiattenuationVector = [-0.46651875  0.18216188  0.12541959]
Diattenuation = 0.516287488642832
CircularDiattenuation = 0.12541959458812751
LinearDiattenuation = 0.5008220205047619
DiattenuationAngle = 1.384664060309693 rad (79.33540669919348 deg)
PolarizanceVector = [-0.08476877 -0.20204637 -0.26307903]
Polarizance = 0.342372684079807
DepolarizationCoefficient = 0.4366652735461514
LinearRetardance = 2.2572802432682404 rad (129.33263111753394 deg)
OpticalRotation = 0.4371035715152117 rad (25.04418985791638 deg)
Retardance = 2.345409580619083 rad (134.38207019902185deg)
RetardanceAngle = 0.7135526418560333 rad (40.88355483876068 deg)
</pre></div></div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Using the Mueller module</a><ul>
<li><a class="reference internal" href="#Mueller-matrices">Mueller matrices</a></li>
<li><a class="reference internal" href="#Stokes-Vectors">Stokes Vectors</a></li>
<li><a class="reference internal" href="#Mueller-matrix-decompositions">Mueller matrix decompositions</a></li>
<li><a class="reference internal" href="#Other-parameters">Other parameters</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="index.html"
                          title="previous chapter">pySCATMECH : A Python Interface to the SCATMECH Library</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="UsingFresnel.html"
                          title="next chapter">Using the Fresnel module</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/UsingMueller.ipynb.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="UsingFresnel.html" title="Using the Fresnel module"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="pySCATMECH : A Python Interface to the SCATMECH Library"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pySCATMECH 0.1.7 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Using the Mueller module</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.1.1.
    </div>
  </body>
</html>