
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Conference Article &#8212; pySCATMECH 0.1.9 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/nature.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Mueller Module" href="mueller.html" />
    <link rel="prev" title="Using the CrossRCW module" href="UsingCrossRCW.html" />
<link rel="stylesheet" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css">
  <script src="https://code.jquery.com/jquery-1.12.4.min.js" type="text/javascript"></script>
  <script src="https://pages.nist.gov/nist-header-footer/js/nist-header-footer.js" type="text/javascript" defer="defer"></script>

<script async type="text/javascript" id="_fed_an_ua_tag" src="https://dap.digitalgov.gov/Universal-Federated-Analytics-Min.js?agency=NIST&subagency=github&pua=UA-66610693-1&yt=true&exts=ppsx,pps,f90,sch,rtf,wrl,txz,m1v,xlsm,msi,xsd,f,tif,eps,mpg,xml,pl,xlt,c">
</script>

  
<script type="text/javascript" src="https://pages.nist.gov/leaveNotice/js/jquery.leaveNotice-nist.min.js"></script>
<script>
$(document).ready(function(){
  // Mark external (non-nist.gov) A tags with class "external"
  //If the adress start with https and ends with nist.gov
  var re_nist = new RegExp('^https?:\/\/((^\/)*\.)*nist\\.gov(\/|$)');
  //Regex to find address that start with https
  var re_absolute_address = new RegExp('^((https?:)?\/\/)');
  $("a").each(function(){
    var url=$(this).attr('href');
    if(re_nist.test(url) || !re_absolute_address.test(url)){
      $(this).addClass('local');
    }else{
      //This a href appears to be external, so tag it
      $(this).addClass('external');
    }
  });
  // Add leaveNotice to external A elements
  $('a.external').leaveNotice();
});
</script>
<link rel="stylesheet" type="text/css" href="https://pages.nist.gov/leaveNotice/css/jquery.leaveNotice.css" />


  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="mueller.html" title="Mueller Module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="UsingCrossRCW.html" title="Using the CrossRCW module"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pySCATMECH 0.1.9 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Conference Article</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<section id="Conference-Article">
<h1>Conference Article<a class="headerlink" href="#Conference-Article" title="Permalink to this heading">¶</a></h1>
<p>The following is a conference proceeding published in <em>Reflection, Scattering, and Diffraction from Surfaces VII</em>, SPIE Proc. <strong>11485</strong>, 11485-17 (2020). To download this as a Jupyter notebook, click on <em>Show Source</em> and save as “SPIEManuscript.ipynb”, i.e., without “.txt”.</p>
<section id="pySCATMECH:-A-Python-interface-to-the-SCATMECH-library-of-scattering-codes">
<h2>pySCATMECH: A Python interface to the SCATMECH library of scattering codes<a class="headerlink" href="#pySCATMECH:-A-Python-interface-to-the-SCATMECH-library-of-scattering-codes" title="Permalink to this heading">¶</a></h2>
<p>Thomas A. Germer</p>
<p>Sensor Science Division, National Institute of Standards and Technology, Gaithersburg, Maryland 20899 USA</p>
<p><strong>Abstract:</strong> The first version of the SCATMECH polarized light scattering C++ class library was released in 2000. This software provides a large number of models for Mueller matrix bidirectional reflectance distribution function (BRDF), models for free-space scatterers, rigorous coupled wave (RCW) analysis of diffraction gratings, reflectance and transmittance of thin film coatings, and manipulation of polarimetric and optical properties. In 2004, the Modeled Integrated Scatter Tool (MIST) was
developed to provide a front-end application for calculating integrated reflectance. While SCATMECH provides efficient codes for modeling, it requires experience with C++ to use, and MIST has limited functionality for many applications. As a result, we have developed a Python interface that provides an intermediate level of access to the SCATMECH library, allowing faster development of applications and test simulations. In this paper, we demonstrate the functionality and use of pySCATMECH using
the example of an interference bandpass filter and calculations of scattering by roughness, particles, and volume scattering within that filter.</p>
<p>Keywords: BRDF, interference, modeling, scattering, simulations</p>
</section>
<section id="1.-Introduction">
<h2>1. Introduction<a class="headerlink" href="#1.-Introduction" title="Permalink to this heading">¶</a></h2>
<p>Modeling is an important step for interpreting light scattering data. In 2000, after collecting a number of scattering models, we published the SCATMECH C++ library of polarized light scattering codes.<a class="reference external" href="http://pages.nist.gov/SCATMECH">[1]</a> SCATMECH is a portmanteau of <em>scattering</em> and <em>mechanics</em>. One of the defining features of the SCATMECH library is that it encapsulated the concept of a model into an abstract class, so that different models for the same quantity can be treated uniformly
under a common umbrella. All models have parameters, and in many cases, parameters can be models themselves. For example, a model for rough surface scattering in the smooth surface approximation requires scalar parameters (e.g., wavelength), the optical constants of the material, which are wavelength-dependent, and a power spectral density (PSD) function for the roughness. The PSD is defined by its own model structure, so that a wide variety of PSD functions can be used.</p>
<p>The SCATMECH codes include models for the bidirectional reflectance distribution function (BRDF), for free-space scattering, and for rigourous coupled wave (RCW) analysis of gratings. Each of these models return their respective quantities (e.g., BRDF, differential cross section, or diffraction efficiency, respectively) as Mueller matrices, so that their full polarimetric properties are modeled. Thus, there is an entire module devoted to performing calculations in the Stokes-Mueller formalism,
and the library is built around this module.</p>
<p>One drawback to the SCATMECH library is that it is written entirely in C++, making it a significant barrier for many potential users. In fact, while it contains a few simple example programs that can be compiled and executed, the library itself is primarily a class library, requiring additional programming by the user. In 2004, there was interest in being able to calculate the signal expected from spherical reference particles on silicon surfaces collected by specific integrated geometries of
wafer surface inspection systems. As a result, we developed the Modeled Integrated Scatter Tool (MIST), <a class="reference external" href="https://pages.nist.gov/ScatterMIST/docs/index.htm">[2]</a> which is an executable program. In 2005, MIST was released with a graphical user interface for Microsoft Windows.* MIST thus became the <em>de facto</em> interface to the SCATMECH library. Since it was ultimately designed to perform the integral of the modeled BRDF over an arbitrary collection geometry, in order to estimate the diffuse
reflectance, its use in other applications is sometimes awkward. For example, use of RCW models in MIST required that an effective BRDF model be added to SCATMECH, since MIST only works with BRDF models.</p>
<p>There has been a lot of recent attention given to the Python programming language. There are several advantages to Python. First, it is an interpreted language, that can either be run in scripts or executed line by line, making it much easier to develop codes for specific applications, even one-off calculations. Python is freely available, and many extensions are available and easy to install. It has also been incorporated into notebook interfaces, such as Jupyter, allowing for code and
visualizations to be interspersed with explanatory text.</p>
<p>As a result, the author has developed a Python interface to the SCATMECH library, called pySCATMECH, for which the first version was be released in July 2020 and can be installed with the common mechanism: <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">pySCATMECH</span></code>. This manuscript is not intended to fully document pySCATMECH but serves as a set of examples that demonstrate some of its features. The code and documentation are available at <a class="reference external" href="http://github.com/usnistgov/pySCATMECH">[3]</a>. This paper is written and organized as a
Jupyter notebook, which will be made available alongside the regular manuscript format.</p>
<p>The organization of this paper is the following: We will construct an interference bandpass filter and show its reflectance properties. We will then consider three mechanisms (models) for light scattering in this film stack. We graph the BRDF at three wavelengths and calculate the diffuse reflectance as a function of wavelength for each of these mechanisms. Finally, we will evalate the integrated cross section of a sphere above the filter as a function of the diameter of the sphere.</p>
<p>*Certain commercial products are identified in this paper in order to specify the procedure adequately. Such identification is not intended to imply recommendation or endorsement by NIST, nor is it intended to imply that these products identified are necessarily the best available for the purpose.</p>
</section>
<section id="2.-First-things-first">
<h2>2. First things first<a class="headerlink" href="#2.-First-things-first" title="Permalink to this heading">¶</a></h2>
<p>Before we start, we need to import the library. Since we will be using some features of the NumPy package and graphing using the PyPlot module of the Matplotlib package, we need to import them as well. Finally, the two symbols <code class="docutils literal notranslate"><span class="pre">pi</span></code> (for <span class="math notranslate nohighlight">\(\pi\)</span>) and <code class="docutils literal notranslate"><span class="pre">deg</span></code> (for <span class="math notranslate nohighlight">\(\pi/180\)</span>) will be very useful.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pySCATMECH</span> <span class="kn">import</span> <span class="n">fresnel</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">brdf</span><span class="p">,</span> <span class="n">integrate</span><span class="p">,</span> <span class="n">local</span><span class="p">,</span> <span class="n">mueller</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">pi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="n">deg</span> <span class="o">=</span> <span class="n">pi</span><span class="o">/</span><span class="mi">180</span>
</pre></div>
</div>
</div>
</section>
<section id="3.-Optical-functions">
<h2>3. Optical functions<a class="headerlink" href="#3.-Optical-functions" title="Permalink to this heading">¶</a></h2>
<p>We start our examples by creating some optical functions. If we already have tabulated data (i.e., optical constants <span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\(k\)</span> as functions of wavelength), we can pass the name of the file containing the data as a string to <code class="docutils literal notranslate"><span class="pre">fresnel.OpticalFunction</span></code>. In this example, we provide Sellmeier expressions for SiO<span class="math notranslate nohighlight">\(_2\)</span> (substrate), MgF (low index film), and ZrO<span class="math notranslate nohighlight">\(_2\)</span> (high index film) that we will use for our demonstration. <a class="reference external" href="https://doi.org/10.1364/JOSA.55.001205">[4]</a>
<a class="reference external" href="https://doi.org/10.1364/AO.23.001980">[5]</a> <a class="reference external" href="https://doi.org/10.1364/AO.21.002978">[6]</a> Because the underlying SCATMECH code requires optical functions to be provided either as constants or as files, pySCATMECH will create temporary files containing the wavelengths tabulated in some range. Here, we only need to coarsely tabulate the data (20 points over the range 0.35 µm to 0.75 µm) in order to describe the materials.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table_wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.350</span><span class="p">,</span> <span class="mf">0.750</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

<span class="n">SiO2</span> <span class="o">=</span> <span class="n">fresnel</span><span class="o">.</span><span class="n">OpticalFunction</span><span class="p">(</span>
              <span class="k">lambda</span> <span class="n">L</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.6961663</span><span class="o">*</span><span class="n">L</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">L</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">0.06840432</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                                  <span class="o">+</span> <span class="mf">0.4079426</span><span class="o">*</span><span class="n">L</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">L</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">0.11624142</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                                  <span class="o">+</span> <span class="mf">0.8974794</span><span class="o">*</span><span class="n">L</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">L</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">9.8961612</span><span class="o">**</span><span class="mi">2</span><span class="p">)),</span>
                                  <span class="n">table_wavelengths</span><span class="p">)</span>
<span class="n">MgF</span> <span class="o">=</span> <span class="n">fresnel</span><span class="o">.</span><span class="n">OpticalFunction</span><span class="p">(</span>
              <span class="k">lambda</span> <span class="n">L</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.48755108</span><span class="o">*</span><span class="n">L</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">L</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">0.04338408</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                                  <span class="o">+</span> <span class="mf">0.39875031</span><span class="o">*</span><span class="n">L</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">L</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">0.09461442</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                                  <span class="o">+</span> <span class="mf">2.3120353</span><span class="o">*</span><span class="n">L</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">L</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">23.793604</span><span class="o">**</span><span class="mi">2</span><span class="p">)),</span>
                                  <span class="n">table_wavelengths</span><span class="p">)</span>
<span class="n">ZrO2</span> <span class="o">=</span> <span class="n">fresnel</span><span class="o">.</span><span class="n">OpticalFunction</span><span class="p">(</span>
              <span class="k">lambda</span> <span class="n">L</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">1.347091</span><span class="o">*</span><span class="n">L</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">L</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">0.062543</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                                  <span class="o">+</span> <span class="mf">2.117788</span><span class="o">*</span><span class="n">L</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">L</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">0.166739</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                                  <span class="o">+</span> <span class="mf">9.452943</span><span class="o">*</span><span class="n">L</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">L</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">24.320570</span><span class="o">**</span><span class="mi">2</span><span class="p">)),</span>
                                  <span class="n">table_wavelengths</span><span class="p">)</span>
<span class="n">vacuum</span> <span class="o">=</span> <span class="n">fresnel</span><span class="o">.</span><span class="n">OpticalFunction</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="4.-Interference-filter">
<h2>4. Interference filter<a class="headerlink" href="#4.-Interference-filter" title="Permalink to this heading">¶</a></h2>
<p>A simple high reflector interference coating consists of alternating high and low index films, each having a quarter-wave thickness at the optimum wavelength. A narrow band interference filter consists of a half-wave thickness layer sandwiched between two high reflectors. For our example, we choose a center wavelength of 0.500 µm and use two five-period high reflectors. We create each film with <code class="docutils literal notranslate"><span class="pre">fresnel.Film</span></code>. A <code class="docutils literal notranslate"><span class="pre">fresnel.FilmStack</span></code>, created with a list of <code class="docutils literal notranslate"><span class="pre">fresnel.Film</span></code>, has a member
<code class="docutils literal notranslate"><span class="pre">Rs</span></code> that returns the reflectance for s-polarization. The example below calculates the reflectance at normal incidence from such a stack on SiO<span class="math notranslate nohighlight">\(_2\)</span> as a function of wavelength. The results are shown in Fig. 1. Notice that the device is only a bandpass filter in a narrow range of wavelengths.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span> <span class="o">=</span> <span class="n">fresnel</span><span class="o">.</span><span class="n">Film</span><span class="p">(</span><span class="n">MgF</span><span class="p">,</span> <span class="n">wavelength</span> <span class="o">=</span> <span class="mf">0.50</span><span class="p">,</span> <span class="n">waves</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">fresnel</span><span class="o">.</span><span class="n">Film</span><span class="p">(</span><span class="n">ZrO2</span><span class="p">,</span> <span class="n">wavelength</span> <span class="o">=</span> <span class="mf">0.50</span><span class="p">,</span> <span class="n">waves</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="n">stack</span> <span class="o">=</span> <span class="n">fresnel</span><span class="o">.</span><span class="n">FilmStack</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="p">[</span><span class="n">H</span><span class="p">,</span><span class="n">L</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">L</span><span class="p">]</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="p">[</span><span class="n">L</span><span class="p">,</span><span class="n">H</span><span class="p">])</span>

<span class="n">wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mi">1600</span><span class="p">)</span>
<span class="n">thetai</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">reflectance</span> <span class="o">=</span> <span class="p">[</span><span class="n">stack</span><span class="o">.</span><span class="n">Rs</span><span class="p">(</span><span class="n">thetai</span><span class="p">,</span> <span class="n">wavelength</span><span class="p">,</span> <span class="n">vacuum</span><span class="p">,</span> <span class="n">SiO2</span><span class="p">)</span> <span class="k">for</span> <span class="n">wavelength</span> <span class="ow">in</span> <span class="n">wavelengths</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span><span class="n">reflectance</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Reflectance&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Wavelength (µm)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/SPIEManuscript2020_12_0.svg" src="_images/SPIEManuscript2020_12_0.svg" /></div>
</div>
<p><strong>Figure 1</strong> Reflectance of the interference filter as a function of wavelength.</p>
</section>
<section id="5.-Scattering-models">
<h2>5. Scattering models<a class="headerlink" href="#5.-Scattering-models" title="Permalink to this heading">¶</a></h2>
<p>We are going to demonstrate scattering from the interference filter described above with three different scattering models, one for random bumps in the interface topography, one for a spherical particle above the stack, and one for small spherical voids randomly placed within the film structure. Figure 2 shows a schematic diagram of the scatterers in the film. Only five films are shown to simplify the figure. In order to compare apples-to-apples, we need to make sure the surface density of the
defects and their respective volumes are the same. The volume of a sphere of radius <span class="math notranslate nohighlight">\(r\)</span> is <span class="math notranslate nohighlight">\(V_\mathrm{sph}=(4/3)\pi r^3\)</span>, while that of a parabolic dimple or mound of radius <span class="math notranslate nohighlight">\(r\)</span> and height <span class="math notranslate nohighlight">\(h\)</span> is <span class="math notranslate nohighlight">\(V_\mathrm{int} = \pi r^2 h/2\)</span>. For the dimples or mounds, we can specify (as a parameter) their density on each interface, so we should divide the density (here, <span class="math notranslate nohighlight">\(\rho\)</span>) by the number of interfaces.</p>
<p><img alt="Figure 2" class="no-scaled-link" src="_images/SPIEFigureSchematic.png" style="width: 50%;" /></p>
<p><strong>Figure 2</strong>: Schematic of the scatterers in the film. Notice that there are the same number of particles on the top, as there are spherical voids distributed within the layers, and dimples or mounds distributed among the interfaces. The number of layers shown is significantly less than that of the filter we are using for the demonstration.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nLayers</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">stack</span><span class="o">.</span><span class="n">films</span><span class="p">)</span>
<span class="n">rho</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># in particles per square micrometer</span>

<span class="n">rInterface</span> <span class="o">=</span> <span class="mf">0.25</span>
<span class="n">hInterface</span> <span class="o">=</span> <span class="mf">0.005</span>
<span class="n">rhoInterface</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">/</span> <span class="p">(</span><span class="n">nLayers</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">VInterface</span> <span class="o">=</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">rInterface</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">hInterface</span><span class="o">/</span><span class="mi">2</span>

<span class="n">rParticle</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">4</span> <span class="o">*</span> <span class="n">VInterface</span> <span class="o">/</span> <span class="n">pi</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="n">rhoParticle</span> <span class="o">=</span> <span class="n">rho</span>

<span class="n">rVolume</span> <span class="o">=</span> <span class="n">rParticle</span>
<span class="n">rhoVolume</span> <span class="o">=</span> <span class="n">rho</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The equivalent particle radius is&quot;</span><span class="p">,</span> <span class="n">rParticle</span><span class="p">,</span> <span class="s2">&quot;µm.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The equivalent particle radius is 0.048935845514610804 µm.
</pre></div></div>
</div>
<section id="5.1-Interface-roughness">
<h3>5.1 Interface roughness<a class="headerlink" href="#5.1-Interface-roughness" title="Permalink to this heading">¶</a></h3>
<p>We use the model <code class="docutils literal notranslate"><span class="pre">Uncorrelated_Roughness_Stack_BRDF_Model</span></code> to model the scattering by surface roughness.<a class="reference external" href="https://doi.org/10.1364/JOSAA.12.000729">[7]</a> In this case, we are considering the surfaces to be uncorrelated with one another, but to have identical parabolic dimples or mounds spread between them. In the following, the power spectral density function is defined by <code class="docutils literal notranslate"><span class="pre">psd</span></code> as a <code class="docutils literal notranslate"><span class="pre">Parabolic_Dimple_PSD_Function</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psd</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s1">&#39;Parabolic_Dimple_PSD_Function&#39;</span><span class="p">,</span>
                  <span class="n">axisx</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">rInterface</span><span class="p">,</span> <span class="n">axisy</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">rInterface</span><span class="p">,</span>
                  <span class="n">height</span><span class="o">=</span><span class="n">hInterface</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="n">rhoInterface</span><span class="p">)</span>
<span class="n">roughnessModel</span> <span class="o">=</span> <span class="n">brdf</span><span class="o">.</span><span class="n">BRDF_Model</span><span class="p">(</span><span class="s1">&#39;Uncorrelated_Roughness_Stack_BRDF_Model&#39;</span><span class="p">,</span>
                                 <span class="n">substrate</span><span class="o">=</span><span class="n">SiO2</span><span class="p">,</span> <span class="n">psd</span><span class="o">=</span><span class="n">psd</span><span class="p">,</span> <span class="n">stack</span><span class="o">=</span><span class="n">stack</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We should note that it would not be expected that the interfaces be uncorrelated, as shown in Fig. 2. If the surfaces are grown sequentially, a mound or dimple will propagate to some degree to the next interface. Another model <code class="docutils literal notranslate"><span class="pre">Growth_Roughness_Stack_BRDF_Model</span></code> would be a more realistic model. However, it is more complicated to use and it doesn’t allow for a constant volume comparison between scatterers.</p>
</section>
<section id="5.2-Particle-above-the-stack">
<h3>5.2 Particle above the stack<a class="headerlink" href="#5.2-Particle-above-the-stack" title="Permalink to this heading">¶</a></h3>
<p>We use the theory of Bobbert and Vlieger (BV) to calculate the scatter from spheres above the top interface.[8][9] The BV theory, which is an accurate theory for scattering from a sphere above a substrate, has been extended to include substrates with films.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">particleModel</span> <span class="o">=</span> <span class="n">brdf</span><span class="o">.</span><span class="n">BRDF_Model</span><span class="p">(</span><span class="s1">&#39;Bobbert_Vlieger_BRDF_Model&#39;</span><span class="p">,</span>
                                <span class="n">substrate</span><span class="o">=</span><span class="n">SiO2</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="n">rhoInterface</span><span class="p">,</span>
                                <span class="n">sphere</span><span class="o">=</span><span class="n">SiO2</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">rParticle</span><span class="p">,</span> <span class="n">stack</span><span class="o">=</span><span class="n">stack</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
</section>
<section id="5.3-Volume-scattering-in-the-stack">
<h3>5.3 Volume scattering in the stack<a class="headerlink" href="#5.3-Volume-scattering-in-the-stack" title="Permalink to this heading">¶</a></h3>
<p>For scattering from spherical inclusions in a dielectric stack, we use the theory described in Refs. <a class="reference external" href="https://doi.org/10.1364/JOSAA.18.001279">[10]</a> and <a class="reference external" href="http://dx.doi.org/10.1117/12.304397">[11]</a>, which is implemented by <code class="docutils literal notranslate"><span class="pre">Rayleigh_Stack_BRDF_Model</span></code>. The <code class="docutils literal notranslate"><span class="pre">Rayleigh_Stack_BRDF_Model</span></code> applies to defects at a specific depth in the layer. Therefore, we need to average over the entire depth of the interference stack. Therefore, in the following, we create a new BRDF model, called
<code class="docutils literal notranslate"><span class="pre">sumBRDF</span></code>, which has just the requirements needed for this manuscript, namely an <code class="docutils literal notranslate"><span class="pre">__init__</span></code> function to initialize the class, a <code class="docutils literal notranslate"><span class="pre">BRDF</span></code> function that returns the BRDF, and a <code class="docutils literal notranslate"><span class="pre">setParameters</span></code> function that allows the parameters to be set once the model has been initialized. In this case, the <code class="docutils literal notranslate"><span class="pre">__init__</span></code> function creates the <code class="docutils literal notranslate"><span class="pre">BRDF_Model</span></code> and determines the total thickness of the stack. The <code class="docutils literal notranslate"><span class="pre">BRDF</span></code> function averages the BRDF over the depth of the defect, passing the geometry and
polarization parameters to the <code class="docutils literal notranslate"><span class="pre">Rayleigh_Stack_BRDF_Model</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">sumBRDF</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nstep</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="o">**</span><span class="n">parameters</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">brdf</span><span class="o">.</span><span class="n">BRDF_Model</span><span class="p">(</span><span class="s1">&#39;Rayleigh_Stack_BRDF_Model&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;stack&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tthick</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">f</span><span class="o">.</span><span class="n">thickness</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">stack</span><span class="o">.</span><span class="n">films</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nstep</span> <span class="o">=</span> <span class="n">nstep</span>

    <span class="k">def</span> <span class="nf">BRDF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">zs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tthick</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nstep</span><span class="p">)</span>
        <span class="n">BRDF</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">zs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">setParameters</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="n">z</span><span class="p">)</span>
            <span class="n">BRDF</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">BRDF</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">BRDF</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">nstep</span>

    <span class="k">def</span> <span class="nf">setParameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="s2">&quot;nstep&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nstep</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;nstep&quot;</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;nstep&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">setParameters</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="n">volumeModel</span> <span class="o">=</span> <span class="n">sumBRDF</span><span class="p">(</span><span class="n">nstep</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">substrate</span><span class="o">=</span><span class="n">SiO2</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="n">rhoVolume</span><span class="p">,</span>
                      <span class="n">stack</span><span class="o">=</span><span class="n">stack</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">rVolume</span><span class="p">,</span> <span class="n">sphere</span><span class="o">=</span><span class="n">vacuum</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="6.-BRDF-and-BTDF">
<h2>6. BRDF and BTDF<a class="headerlink" href="#6.-BRDF-and-BTDF" title="Permalink to this heading">¶</a></h2>
<p>Now that we have set up the three models, we can see what the BRDF and bidirectional transmittance distribution function (BTDF) are. As for the SCATMECH library, the BRDF is accessed using the parameter <code class="docutils literal notranslate"><span class="pre">type=0</span></code>, while BTDF is accessed using <code class="docutils literal notranslate"><span class="pre">type=1</span></code>. Note that <code class="docutils literal notranslate"><span class="pre">type</span></code> is a standard function in Python that normally returns the data type of an object. Here <code class="docutils literal notranslate"><span class="pre">type</span></code> corresponds to the geometry of the measurement. Thus, some care should be taken to not overwrite the standard function. Also,
note that the keyword <code class="docutils literal notranslate"><span class="pre">wavelength</span></code> is used in place of the parameter <code class="docutils literal notranslate"><span class="pre">lambda</span></code>, which SCATMECH uses for wavelength, since <code class="docutils literal notranslate"><span class="pre">lambda</span></code> is a dedicated keyword in Python.</p>
<p>In the code below, note that incident polarizations are specified by Stokes vectors or by using specific named polarizations with <code class="docutils literal notranslate"><span class="pre">mueller.Polarization</span></code>. Similarly, detector sensitivities are specified by Stokes vectors or using named polarizations using <code class="docutils literal notranslate"><span class="pre">mueller.Sensitivity</span></code>. Using the functions ensures that the result is properly normalized.</p>
<p>The code below calculates the BRDF and BTDF for wavelengths 0.01 µm below, at, and 0.01 µm above the nominal pass wavelength of the filter and for normal incidence, respectively. We use unpolarized incident light with unpolarized sensitivity. In the following block of code, we calculate the bidirectional scattering distribution function (BSDF) for each wavelength and store them in dictionaries.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">89</span><span class="p">,</span><span class="mi">89</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>

<span class="n">wavelengths</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.490</span><span class="p">,</span><span class="mf">0.500</span><span class="p">,</span><span class="mf">0.510</span><span class="p">]</span>

<span class="n">inpol</span> <span class="o">=</span> <span class="n">mueller</span><span class="o">.</span><span class="n">Polarization</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">)</span>
<span class="n">sens</span> <span class="o">=</span> <span class="n">mueller</span><span class="o">.</span><span class="n">Sensitivity</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">)</span>

<span class="n">roughnessBSDF</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">particleBSDF</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">volumeBSDF</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

<span class="k">for</span> <span class="n">wavelength</span> <span class="ow">in</span> <span class="n">wavelengths</span><span class="p">:</span>
    <span class="n">roughnessBSDF</span><span class="p">[</span><span class="n">wavelength</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">particleBSDF</span><span class="p">[</span><span class="n">wavelength</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">volumeBSDF</span><span class="p">[</span><span class="n">wavelength</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">BSDFtype</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
        <span class="n">roughnessModel</span><span class="o">.</span><span class="n">setParameters</span><span class="p">(</span><span class="n">wavelength</span><span class="o">=</span><span class="n">wavelength</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">BSDFtype</span><span class="p">)</span>
        <span class="n">particleModel</span><span class="o">.</span><span class="n">setParameters</span><span class="p">(</span><span class="n">wavelength</span><span class="o">=</span><span class="n">wavelength</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">BSDFtype</span><span class="p">)</span>
        <span class="n">volumeModel</span><span class="o">.</span><span class="n">setParameters</span><span class="p">(</span><span class="n">wavelength</span><span class="o">=</span><span class="n">wavelength</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">BSDFtype</span><span class="p">)</span>
        <span class="n">roughnessBSDF</span><span class="p">[</span><span class="n">wavelength</span><span class="p">][</span><span class="n">BSDFtype</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">roughnessModel</span><span class="o">.</span><span class="n">BRDF</span><span class="p">(</span><span class="n">thetai</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">thetas</span><span class="o">=</span><span class="n">t</span><span class="o">*</span><span class="n">deg</span><span class="p">,</span> <span class="n">inc</span><span class="o">=</span><span class="n">inpol</span><span class="p">,</span> <span class="n">sens</span><span class="o">=</span><span class="n">sens</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">angles</span><span class="p">]</span>
        <span class="n">particleBSDF</span><span class="p">[</span><span class="n">wavelength</span><span class="p">][</span><span class="n">BSDFtype</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">particleModel</span><span class="o">.</span><span class="n">BRDF</span><span class="p">(</span><span class="n">thetai</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">thetas</span><span class="o">=</span><span class="n">t</span><span class="o">*</span><span class="n">deg</span><span class="p">,</span> <span class="n">inc</span><span class="o">=</span><span class="n">inpol</span><span class="p">,</span> <span class="n">sens</span><span class="o">=</span><span class="n">sens</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">angles</span><span class="p">]</span>
        <span class="n">volumeBSDF</span><span class="p">[</span><span class="n">wavelength</span><span class="p">][</span><span class="n">BSDFtype</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">volumeModel</span><span class="o">.</span><span class="n">BRDF</span><span class="p">(</span><span class="n">thetai</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">thetas</span><span class="o">=</span><span class="n">t</span><span class="o">*</span><span class="n">deg</span><span class="p">,</span> <span class="n">inc</span><span class="o">=</span><span class="n">inpol</span><span class="p">,</span> <span class="n">sens</span><span class="o">=</span><span class="n">sens</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">angles</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>The following code does not use any pySCATMECH features, but it graphs the results from the calculations above.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="k">for</span> <span class="n">wavelength</span> <span class="ow">in</span> <span class="n">wavelengths</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">angles</span><span class="p">,</span> <span class="n">roughnessBSDF</span><span class="p">[</span><span class="n">wavelength</span><span class="p">][</span><span class="n">t</span><span class="p">],</span>
                        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$\lambda=</span><span class="si">%4.2f</span><span class="s2">$ µm&quot;</span> <span class="o">%</span> <span class="n">wavelength</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">angles</span><span class="p">,</span> <span class="n">particleBSDF</span><span class="p">[</span><span class="n">wavelength</span><span class="p">][</span><span class="n">t</span><span class="p">],</span>
                        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$\lambda=</span><span class="si">%4.2f</span><span class="s2">$ µm&quot;</span> <span class="o">%</span> <span class="n">wavelength</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">angles</span><span class="p">,</span> <span class="n">volumeBSDF</span><span class="p">[</span><span class="n">wavelength</span><span class="p">][</span><span class="n">t</span><span class="p">],</span>
                        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$\lambda=</span><span class="si">%4.2f</span><span class="s2">$ µm&quot;</span> <span class="o">%</span> <span class="n">wavelength</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Roughness&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Particle&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Volume&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;BRDF (sr$^{-1}$)&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;BTDF (sr$^{-1}$)&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
        <span class="n">a</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
        <span class="n">a</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">))</span>
        <span class="n">a</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
    <span class="n">a</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Angle (°)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/SPIEManuscript2020_32_0.svg" src="_images/SPIEManuscript2020_32_0.svg" /></div>
</div>
<p><strong>Figure 3:</strong> The (top row) BRDF and the (bottom row) BTDF calculated for three different models: (left column) roughness of the interfaces, (middle column) spherical particles above the layers, and (right column) spherical voids distributed in the films. The calculations are performed for three wavelengths, 0.49 µm, 0.50 µm, and 0.51 µm.</p>
<p>The BTDFs shown in Fig. 3 are evaluated inside the substrate. Thus, angles outside of approximately 43° are trapped in the substrate.</p>
<p>There are a number of things that can be observed in Fig. 3. Each scattering mechanism is strongly wavelength dependent exhibiting different behavior below, at, and above the nominal wavelength of the filter. For roughness and for volume scattering, the scattering levels are significantly higher at the resonance wavelength. That this is not true for the particles is understandable, since, at the center wavelength, the reflectance of the stack is minimal, and the particle, to some degree does not
see the substrate at normal incidence.</p>
<p>The structure observed at 0.49 µm is a result of angle tuning of the filter. At non-normal incidence, the pass wavelength of the filter shifts to shorter wavelength. Thus, there are peaks on each side of the normal viewing direction.</p>
</section>
<section id="7.-Integrated-Reflectance">
<h2>7. Integrated Reflectance<a class="headerlink" href="#7.-Integrated-Reflectance" title="Permalink to this heading">¶</a></h2>
<p>In many applications, one is interested in simulating integrated diffuse reflectance. Integration of the BRDF was the primary function of MIST. <a class="reference external" href="https://pages.nist.gov/ScatterMIST/docs/index.htm">[2]</a> However, in developing pySCATMECH, we wanted to ensure that this capability was maintained, if not improved. The <code class="docutils literal notranslate"><span class="pre">integrate</span></code> module of pySCATMECH provides the tools for performing BRDF integration. The first step to using this module is to define the solid angle over which radiation is
collected. This is performed by combining a number of different shapes using boolean operations (<code class="docutils literal notranslate"><span class="pre">&amp;</span></code>, <code class="docutils literal notranslate"><span class="pre">|</span></code>, and <code class="docutils literal notranslate"><span class="pre">~</span></code>). For example, in the following, we define the collection angles by combining the full hemisphere and subtracting (using an “and not” operation) a circular cone (radius of 10°) about the surface normal. The step size at the surface normal is 2° in each direction. The <code class="docutils literal notranslate"><span class="pre">PlotSamplePoints</span></code> function shows integration points, using symbols sized to indicate the weighting function
for integration.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hemisphere</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">Hemisphere</span><span class="p">()</span>
<span class="n">cone</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">CircularCone</span><span class="p">(</span><span class="n">theta</span><span class="o">=</span><span class="mi">0</span><span class="o">*</span><span class="n">deg</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="n">deg</span><span class="p">)</span>
<span class="n">integrator</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">Integrator</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">deg</span><span class="p">,</span> <span class="n">hemisphere</span> <span class="o">&amp;</span> <span class="o">~</span> <span class="n">cone</span><span class="p">)</span>
<span class="n">integrator</span><span class="o">.</span><span class="n">PlotSamplingPoints</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/SPIEManuscript2020_37_0.svg" src="_images/SPIEManuscript2020_37_0.svg" /></div>
</div>
<p><strong>Figure 4:</strong> The integration points used in this demonstration, shown as projected cosines, with the surface normal at the center and the plane of incidence being a horizontal line through the center. The area of each point represents the relative weighting factor for each direction.</p>
<p>Once we have the <code class="docutils literal notranslate"><span class="pre">Integrator</span></code>, we can use it with a <code class="docutils literal notranslate"><span class="pre">BRDF_Model</span></code> to calculate the reflectance. In the following we calculate the integrated scatter for each of the three scattering mechanisms for an incident angle of 2.5° as a function of wavelength. To assist us, we write a function <code class="docutils literal notranslate"><span class="pre">DiffuseScatter</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">DiffuseScatter</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">wavelengths</span><span class="p">,</span> <span class="nb">type</span><span class="p">):</span>
    <span class="n">model</span><span class="o">.</span><span class="n">setParameters</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="nb">type</span><span class="p">)</span>
    <span class="n">refs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">wavelength</span> <span class="ow">in</span> <span class="n">wavelengths</span><span class="p">:</span>
        <span class="n">model</span><span class="o">.</span><span class="n">setParameters</span><span class="p">(</span><span class="n">wavelength</span><span class="o">=</span><span class="n">wavelength</span><span class="p">)</span>
        <span class="n">refs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">integrator</span><span class="o">.</span><span class="n">Reflectance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="mf">2.5</span><span class="o">*</span><span class="n">deg</span><span class="p">,</span> <span class="n">incpol</span><span class="o">=</span><span class="n">mueller</span><span class="o">.</span><span class="n">Polarization</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">refs</span><span class="p">)</span>

<span class="n">wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span>

<span class="n">roughnessReflectance</span> <span class="o">=</span> <span class="n">DiffuseScatter</span><span class="p">(</span><span class="n">roughnessModel</span><span class="p">,</span> <span class="n">wavelengths</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">particleReflectance</span> <span class="o">=</span> <span class="n">DiffuseScatter</span><span class="p">(</span><span class="n">particleModel</span><span class="p">,</span> <span class="n">wavelengths</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">volumeReflectance</span> <span class="o">=</span> <span class="n">DiffuseScatter</span><span class="p">(</span><span class="n">volumeModel</span><span class="p">,</span> <span class="n">wavelengths</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">roughnessTransmittance</span> <span class="o">=</span> <span class="n">DiffuseScatter</span><span class="p">(</span><span class="n">roughnessModel</span><span class="p">,</span> <span class="n">wavelengths</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">particleTransmittance</span> <span class="o">=</span> <span class="n">DiffuseScatter</span><span class="p">(</span><span class="n">particleModel</span><span class="p">,</span> <span class="n">wavelengths</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">volumeTransmittance</span> <span class="o">=</span> <span class="n">DiffuseScatter</span><span class="p">(</span><span class="n">volumeModel</span><span class="p">,</span> <span class="n">wavelengths</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The above code is somewhat time consuming to run, because <code class="docutils literal notranslate"><span class="pre">volumeModel</span></code> must average over defect depth and there are many directions to sample. In the following, we graph the results.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="p">((</span><span class="n">ax1</span><span class="p">,</span><span class="n">ax2</span><span class="p">,</span><span class="n">ax3</span><span class="p">),(</span><span class="n">ax4</span><span class="p">,</span><span class="n">ax5</span><span class="p">,</span><span class="n">ax6</span><span class="p">))</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="n">wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mi">101</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">roughnessReflectance</span><span class="p">)</span><span class="o">*</span><span class="mf">1E5</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">particleReflectance</span><span class="p">)</span><span class="o">*</span><span class="mf">1E5</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">volumeReflectance</span><span class="p">)</span><span class="o">*</span><span class="mf">1E5</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">roughnessTransmittance</span><span class="p">)</span><span class="o">*</span><span class="mf">1E5</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">particleTransmittance</span><span class="p">)</span><span class="o">*</span><span class="mf">1E5</span><span class="p">)</span>
<span class="n">ax6</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">volumeTransmittance</span><span class="p">)</span><span class="o">*</span><span class="mf">1E5</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Reflectance $\times 10^5$&quot;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Transmittance $\times 10^5$&quot;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Wavelength (µm)&quot;</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Wavelength (µm)&quot;</span><span class="p">)</span>
<span class="n">ax6</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Wavelength (µm)&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Roughness&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Particle&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Volume&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/SPIEManuscript2020_42_0.svg" src="_images/SPIEManuscript2020_42_0.svg" /></div>
</div>
<p><strong>Figure 5</strong> The calculated (top row) integrated reflectance and (bottom row) integrated transmittance as a function of wavelength for three different models: (left column) roughness of the interfaces, (middle column) spherical particles above the layers, and (right column) spherical voids distributed in the films. The calculations are performed for an incident angle of 2.5°.</p>
<p>The results are shown in Fig. 5. For the roughness model and the volume scattering model, we can see a strong enhancement in the scattering function at the design wavelength for the filter. For the particle scattering, the effect of the filter bandpass is significantly less. Over the entire spectral range, the scattering is the least for the particles in transmission, which is not too surprising, given that the material is a high reflector at most wavelengths in the region shown.</p>
</section>
<section id="8.-Cross-section">
<h2>8. Cross section<a class="headerlink" href="#8.-Cross-section" title="Permalink to this heading">¶</a></h2>
<p>For isolated defects, the integrated cross section is a more appropriate quantity than BRDF to express the scattering function. In SCATMECH, models inheriting <code class="docutils literal notranslate"><span class="pre">Local_BRDF_Model</span></code> return the differential cross section for a given geometry, instead of the BRDF. <code class="docutils literal notranslate"><span class="pre">Local_BRDF_Model</span></code> uses a surface density (as above for <code class="docutils literal notranslate"><span class="pre">particleModel</span></code> and <code class="docutils literal notranslate"><span class="pre">volumeModel</span></code>) to determine the BRDF. MIST was able to calculate integrated cross section, but it did so by reverse-engineering that conversion. Thus, it was
rather clumsy and confusing to use. In developing pySCATMECH, we make the calculation of the cross section more organic. Those models that inherit <code class="docutils literal notranslate"><span class="pre">Local_BRDF_Model</span></code> are created as such, so that their differential cross section functions can be accessed.</p>
<p>In the following, we calculate the integrated cross section for scattering by a single sphere on top of the film stack as a function of sphere diameter at the three wavelengths studied above ($:nbsphinx-math:<a href="#id1"><span class="problematic" id="id2">`</span></a>lambda <a href="#id3"><span class="problematic" id="id4">`</span></a>= $ 0.49 µm, 0.50 µm, and 0.51 µm). Note that we are spreading the diameters out on a logarithmic scale.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">localParticleModel</span> <span class="o">=</span> <span class="n">local</span><span class="o">.</span><span class="n">Local_BRDF_Model</span><span class="p">(</span><span class="s1">&#39;Bobbert_Vlieger_BRDF_Model&#39;</span><span class="p">,</span>
                           <span class="n">wavelength</span><span class="o">=</span><span class="mf">0.500</span><span class="p">,</span> <span class="n">substrate</span><span class="o">=</span><span class="n">SiO2</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sphere</span><span class="o">=</span><span class="n">SiO2</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">stack</span><span class="o">=</span><span class="n">stack</span><span class="p">)</span>

<span class="n">wavelengths</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.490</span><span class="p">,</span> <span class="mf">0.500</span><span class="p">,</span> <span class="mf">0.510</span><span class="p">]</span>
<span class="k">def</span> <span class="nf">plotSigmaVsD</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">wavelength</span><span class="p">):</span>
    <span class="n">model</span><span class="o">.</span><span class="n">setParameters</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="n">wavelength</span><span class="p">)</span>

    <span class="n">refs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">diameters</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">100</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">D</span> <span class="ow">in</span> <span class="n">diameters</span><span class="p">:</span>
        <span class="n">model</span><span class="o">.</span><span class="n">setParameters</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="n">D</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">refs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">integrator</span><span class="o">.</span><span class="n">CrossSection</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="mf">2.5</span><span class="o">*</span><span class="n">deg</span><span class="p">,</span> <span class="n">incpol</span><span class="o">=</span><span class="n">mueller</span><span class="o">.</span><span class="n">Polarization</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">)))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">diameters</span><span class="p">,</span> <span class="n">refs</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$\lambda = $</span><span class="si">%4.2f</span><span class="s2"> µm&quot;</span> <span class="o">%</span> <span class="n">wavelength</span><span class="p">)</span>

<span class="k">for</span> <span class="n">wavelength</span> <span class="ow">in</span> <span class="n">wavelengths</span><span class="p">:</span>
    <span class="n">plotSigmaVsD</span><span class="p">(</span><span class="n">localParticleModel</span><span class="p">,</span> <span class="n">wavelength</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Diameter (µm)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Cross section (µm$^2$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/SPIEManuscript2020_47_0.svg" src="_images/SPIEManuscript2020_47_0.svg" /></div>
</div>
<p><strong>Figure 6:</strong> The cross section for integrated reflective scatter of SiO<span class="math notranslate nohighlight">\(_2\)</span> spheres on top of the interference filter as a function of diameter for wavelengths below, at, and above the design wavelength of the filter.</p>
<p>Figure 6 shows the results of the calculations for integrated cross section as a function of sphere diameter <span class="math notranslate nohighlight">\(D\)</span>. At small diameters, the results show a very strong diameter dependence, significantly greater than <span class="math notranslate nohighlight">\(D^6\)</span> (typical for Rayleigh scattering), especially above and below the design wavelength, where the stack is highly reflective. At larger diameters, oscillations in the cross section can be observed. Those oscillations appear stronger above and below the design wavelength.
At larger diameter, the curves approach a <span class="math notranslate nohighlight">\(D^2\)</span> dependence, due to the geometric cross section being proportional to area.</p>
</section>
<section id="9.-Summary">
<h2>9. Summary<a class="headerlink" href="#9.-Summary" title="Permalink to this heading">¶</a></h2>
<p>In this proceedings, we introduce pySCATMECH, a Python inteface to the SCATMECH library of scattering models. This manuscript is intended as an introduction and not a full tutorial. Further information can be found in the full documentation <a class="reference external" href="http://pages.nist.gov/pySCATMECH">[3]</a>. It is anticipated that pySCATMECH will evolve to some degree after its first release. This manuscript is available as a Jupyter notebook located in the documentation. <a class="reference external" href="http://github.com/usnistgov/pySCATMECH">[3]</a></p>
</section>
<section id="References">
<h2>References<a class="headerlink" href="#References" title="Permalink to this heading">¶</a></h2>
<p><a class="reference external" href="http://pages.nist.gov/SCATMECH">1. SCATMECH: Polarized Light Scattering C++ Class Library, available online at https://pages.nist.gov/SCATMECH/index.htm.</a></p>
<p><a class="reference external" href="https://pages.nist.gov/ScatterMIST/docs/index.htm">2. Modeled Integrated Scatter Tool (MIST), available online at https://pages.nist.gov/ScatterMIST/docs/index.htm.</a></p>
<p><a class="reference external" href="http://github.com/usnistgov/pySCATMECH">3. pySCATMECH, available online at http://github.com/usnistgov/pySCATMECH.</a></p>
<p><a class="reference external" href="https://doi.org/10.1364/JOSA.55.001205">4. I. H. Malitson, “Interspecimen Comparison of the Refractive Index of Fused Silica,” J. Opt. Soc. Am. 55, 1205-1209 (1965).</a></p>
<p><a class="reference external" href="https://doi.org/10.1364/AO.23.001980">5. Marilyn J. Dodge, “Refractive properties of magnesium fluoride,” Appl. Opt. 23, 1980-1985 (1984).</a></p>
<p><a class="reference external" href="https://doi.org/10.1364/AO.21.002978">6. D. L. Wood and K. Nassau, “Refractive index of cubic zirconia stabilized with yttria,” Appl. Opt. 21, 2978-2981 (1982).</a></p>
<p><a class="reference external" href="https://doi.org/10.1364/JOSAA.12.000729">7. J. Merle Elson, “Multilayer-coated optics: guided-wave coupling and scattering by means of interface random roughness,” J. Opt. Soc. Am. A 12, 729-742 (1995).</a></p>
<p><a class="reference external" href="https://doi.org/10.1016/0378-4371(86)90072-5">8. P. A. Bobbert and J. Vlieger, “Light scattering by a sphere on a substrate,” Physica 137A, 209-242 (1986).</a></p>
<p><a class="reference external" href="https://doi.org/10.1016/0378-4371(86)90073-7">9. P. A. Bobbert, J. Vlieger, and R. Greef, Light refelction from a substrate sparsely seeded with spheres-comparison with an ellipsometric experiment,” Physica 137A, 243-257 (1986).</a></p>
<p><a class="reference external" href="https://doi.org/10.1364/JOSAA.18.001279">10. Thomas A. Germer, “Polarized light scattering by microroughness and small defects in dielectric layers,” J. Opt. Soc. Am. A 18, 1279-1288 (2001).</a></p>
<p><a class="reference external" href="http://dx.doi.org/10.1117/12.304397">11. Thomas A. Germer, “Application of bidirectional ellipsometry to the characterization of roughness and defects in dielectric layers,” in Flatness, Roughness, and Discrete Defects Characterization for Computer Disks, Wafers, and Flat Panel Displays II, Proc. SPIE 3275, 121-131 (1998).</a></p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Conference Article</a><ul>
<li><a class="reference internal" href="#pySCATMECH:-A-Python-interface-to-the-SCATMECH-library-of-scattering-codes">pySCATMECH: A Python interface to the SCATMECH library of scattering codes</a></li>
<li><a class="reference internal" href="#1.-Introduction">1. Introduction</a></li>
<li><a class="reference internal" href="#2.-First-things-first">2. First things first</a></li>
<li><a class="reference internal" href="#3.-Optical-functions">3. Optical functions</a></li>
<li><a class="reference internal" href="#4.-Interference-filter">4. Interference filter</a></li>
<li><a class="reference internal" href="#5.-Scattering-models">5. Scattering models</a><ul>
<li><a class="reference internal" href="#5.1-Interface-roughness">5.1 Interface roughness</a></li>
<li><a class="reference internal" href="#5.2-Particle-above-the-stack">5.2 Particle above the stack</a></li>
<li><a class="reference internal" href="#5.3-Volume-scattering-in-the-stack">5.3 Volume scattering in the stack</a></li>
</ul>
</li>
<li><a class="reference internal" href="#6.-BRDF-and-BTDF">6. BRDF and BTDF</a></li>
<li><a class="reference internal" href="#7.-Integrated-Reflectance">7. Integrated Reflectance</a></li>
<li><a class="reference internal" href="#8.-Cross-section">8. Cross section</a></li>
<li><a class="reference internal" href="#9.-Summary">9. Summary</a></li>
<li><a class="reference internal" href="#References">References</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="UsingCrossRCW.html"
                          title="previous chapter">Using the CrossRCW module</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="mueller.html"
                          title="next chapter">Mueller Module</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/SPIEManuscript2020.ipynb.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="mueller.html" title="Mueller Module"
             >next</a> |</li>
        <li class="right" >
          <a href="UsingCrossRCW.html" title="Using the CrossRCW module"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pySCATMECH 0.1.9 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Conference Article</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.1.1.
    </div>
  </body>
</html>